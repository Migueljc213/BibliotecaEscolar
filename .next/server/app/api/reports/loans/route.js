"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/reports/loans/route";
exports.ids = ["app/api/reports/loans/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Freports%2Floans%2Froute&page=%2Fapi%2Freports%2Floans%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Freports%2Floans%2Froute.ts&appDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Freports%2Floans%2Froute&page=%2Fapi%2Freports%2Floans%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Freports%2Floans%2Froute.ts&appDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Miguel_projetos_biblioteca_src_app_api_reports_loans_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/reports/loans/route.ts */ \"(rsc)/./src/app/api/reports/loans/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/reports/loans/route\",\n        pathname: \"/api/reports/loans\",\n        filename: \"route\",\n        bundlePath: \"app/api/reports/loans/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Miguel\\\\projetos\\\\biblioteca\\\\src\\\\app\\\\api\\\\reports\\\\loans\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Miguel_projetos_biblioteca_src_app_api_reports_loans_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/reports/loans/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZyZXBvcnRzJTJGbG9hbnMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnJlcG9ydHMlMkZsb2FucyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnJlcG9ydHMlMkZsb2FucyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNNaWd1ZWwlNUNwcm9qZXRvcyU1Q2JpYmxpb3RlY2ElNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q01pZ3VlbCU1Q3Byb2pldG9zJTVDYmlibGlvdGVjYSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDZ0M7QUFDN0c7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaWJsaW90ZWNhLWVzY29sYXIvP2NiMDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcTWlndWVsXFxcXHByb2pldG9zXFxcXGJpYmxpb3RlY2FcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxccmVwb3J0c1xcXFxsb2Fuc1xcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcmVwb3J0cy9sb2Fucy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3JlcG9ydHMvbG9hbnNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3JlcG9ydHMvbG9hbnMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxNaWd1ZWxcXFxccHJvamV0b3NcXFxcYmlibGlvdGVjYVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxyZXBvcnRzXFxcXGxvYW5zXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9yZXBvcnRzL2xvYW5zL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Freports%2Floans%2Froute&page=%2Fapi%2Freports%2Floans%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Freports%2Floans%2Froute.ts&appDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/reports/loans/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/reports/loans/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_loans__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/loans */ \"(rsc)/./src/lib/services/loans.ts\");\n\n\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const period = searchParams.get(\"period\") || \"mes\";\n        // Buscar empréstimos por período\n        const loans = await _lib_services_loans__WEBPACK_IMPORTED_MODULE_1__.LoanService.getLoansByPeriod(period);\n        // Calcular estatísticas\n        const totalLoans = loans.length;\n        const activeLoans = loans.filter((loan)=>loan.status === \"ACTIVE\").length;\n        const returnedLoans = loans.filter((loan)=>loan.status === \"RETURNED\").length;\n        const overdueLoans = loans.filter((loan)=>loan.status === \"ACTIVE\" && new Date(loan.dueDate) < new Date()).length;\n        // Agrupar por mês\n        const monthlyLoans = loans.reduce((acc, loan)=>{\n            const month = new Date(loan.borrowedAt).toLocaleDateString(\"pt-BR\", {\n                month: \"short\"\n            });\n            if (!acc[month]) {\n                acc[month] = {\n                    loans: 0,\n                    returns: 0\n                };\n            }\n            acc[month].loans++;\n            if (loan.status === \"RETURNED\") {\n                acc[month].returns++;\n            }\n            return acc;\n        }, {});\n        // Agrupar por semana (últimas 4 semanas)\n        const loanTrends = [];\n        for(let i = 3; i >= 0; i--){\n            const weekStart = new Date();\n            weekStart.setDate(weekStart.getDate() - i * 7);\n            const weekEnd = new Date(weekStart);\n            weekEnd.setDate(weekEnd.getDate() + 6);\n            const weekLoans = loans.filter((loan)=>{\n                const loanDate = new Date(loan.borrowedAt);\n                return loanDate >= weekStart && loanDate <= weekEnd;\n            });\n            const weekReturns = weekLoans.filter((loan)=>loan.status === \"RETURNED\").length;\n            loanTrends.push({\n                period: `Semana ${4 - i}`,\n                loans: weekLoans.length,\n                returns: weekReturns\n            });\n        }\n        // Livros mais emprestados\n        const bookStats = loans.reduce((acc, loan)=>{\n            const bookTitle = loan.book.title;\n            const bookCode = loan.book.code;\n            if (!acc[bookTitle]) {\n                acc[bookTitle] = {\n                    title: bookTitle,\n                    code: bookCode,\n                    author: loan.book.author,\n                    loans: 0,\n                    returns: 0\n                };\n            }\n            acc[bookTitle].loans++;\n            if (loan.status === \"RETURNED\") {\n                acc[bookTitle].returns++;\n            }\n            return acc;\n        }, {});\n        const topLoanedBooks = Object.values(bookStats).sort((a, b)=>b.loans - a.loans).slice(0, 5);\n        // Maiores usuários\n        const borrowerStats = loans.reduce((acc, loan)=>{\n            const borrowerName = loan.student.name;\n            if (!acc[borrowerName]) {\n                acc[borrowerName] = {\n                    name: borrowerName,\n                    registration: loan.student.registration,\n                    grade: loan.student.grade,\n                    class: loan.student.class,\n                    loans: 0,\n                    returns: 0\n                };\n            }\n            acc[borrowerName].loans++;\n            if (loan.status === \"RETURNED\") {\n                acc[borrowerName].returns++;\n            }\n            return acc;\n        }, {});\n        const topBorrowers = Object.values(borrowerStats).sort((a, b)=>b.loans - a.loans).slice(0, 5);\n        // Converter monthlyLoans para array\n        const monthlyLoansArray = Object.entries(monthlyLoans).map(([month, stats])=>({\n                month,\n                loans: stats.loans,\n                returns: stats.returns\n            })).sort((a, b)=>{\n            const months = [\n                \"jan\",\n                \"fev\",\n                \"mar\",\n                \"abr\",\n                \"mai\",\n                \"jun\",\n                \"jul\",\n                \"ago\",\n                \"set\",\n                \"out\",\n                \"nov\",\n                \"dez\"\n            ];\n            return months.indexOf(a.month.toLowerCase()) - months.indexOf(b.month.toLowerCase());\n        });\n        const reportData = {\n            totalLoans,\n            activeLoans,\n            returnedLoans,\n            overdueLoans,\n            monthlyLoans: monthlyLoansArray,\n            topLoanedBooks,\n            topBorrowers,\n            loanTrends\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(reportData);\n    } catch (error) {\n        console.error(\"Erro ao gerar relat\\xf3rio de empr\\xe9stimos:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Erro interno do servidor\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9yZXBvcnRzL2xvYW5zL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1RDtBQUNMO0FBSTNDLGVBQWVFLElBQUlDLE9BQW9CO0lBQzVDLElBQUk7UUFDRixNQUFNLEVBQUVDLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlGLFFBQVFHLEdBQUc7UUFDNUMsTUFBTUMsU0FBU0gsYUFBYUksR0FBRyxDQUFDLGFBQWE7UUFFN0MsaUNBQWlDO1FBQ2pDLE1BQU1DLFFBQVEsTUFBTVIsNERBQVdBLENBQUNTLGdCQUFnQixDQUFDSDtRQUVqRCx3QkFBd0I7UUFDeEIsTUFBTUksYUFBYUYsTUFBTUcsTUFBTTtRQUMvQixNQUFNQyxjQUFjSixNQUFNSyxNQUFNLENBQUNDLENBQUFBLE9BQVFBLEtBQUtDLE1BQU0sS0FBSyxVQUFVSixNQUFNO1FBQ3pFLE1BQU1LLGdCQUFnQlIsTUFBTUssTUFBTSxDQUFDQyxDQUFBQSxPQUFRQSxLQUFLQyxNQUFNLEtBQUssWUFBWUosTUFBTTtRQUM3RSxNQUFNTSxlQUFlVCxNQUFNSyxNQUFNLENBQUNDLENBQUFBLE9BQ2hDQSxLQUFLQyxNQUFNLEtBQUssWUFBWSxJQUFJRyxLQUFLSixLQUFLSyxPQUFPLElBQUksSUFBSUQsUUFDekRQLE1BQU07UUFFUixrQkFBa0I7UUFDbEIsTUFBTVMsZUFBZVosTUFBTWEsTUFBTSxDQUFDLENBQUNDLEtBQVVSO1lBQzNDLE1BQU1TLFFBQVEsSUFBSUwsS0FBS0osS0FBS1UsVUFBVSxFQUFFQyxrQkFBa0IsQ0FBQyxTQUFTO2dCQUFFRixPQUFPO1lBQVE7WUFDckYsSUFBSSxDQUFDRCxHQUFHLENBQUNDLE1BQU0sRUFBRTtnQkFDZkQsR0FBRyxDQUFDQyxNQUFNLEdBQUc7b0JBQUVmLE9BQU87b0JBQUdrQixTQUFTO2dCQUFFO1lBQ3RDO1lBQ0FKLEdBQUcsQ0FBQ0MsTUFBTSxDQUFDZixLQUFLO1lBQ2hCLElBQUlNLEtBQUtDLE1BQU0sS0FBSyxZQUFZO2dC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LG9CQUFvQmQsT0FBT2UsT0FBTyxDQUFDeEMsY0FDdEN5QyxHQUFHLENBQUMsQ0FBQyxDQUFDdEMsT0FBT3VDLE1BQXFCLEdBQU07Z0JBQ3ZDdkM7Z0JBQ0FmLE9BQU9zRCxNQUFNdEQsS0FBSztnQkFDbEJrQixTQUFTb0MsTUFBTXBDLE9BQU87WUFDeEIsSUFDQ3FCLElBQUksQ0FBQyxDQUFDQyxHQUFHQztZQUNSLE1BQU1jLFNBQVM7Z0JBQUM7Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87Z0JBQU87YUFBTTtZQUNuRyxPQUFPQSxPQUFPQyxPQUFPLENBQUNoQixFQUFFekIsS0FBSyxDQUFDMEMsV0FBVyxNQUFNRixPQUFPQyxPQUFPLENBQUNmLEVBQUUxQixLQUFLLENBQUMwQyxXQUFXO1FBQ25GO1FBRUYsTUFBTUMsYUFBYTtZQUNqQnhEO1lBQ0FFO1lBQ0FJO1lBQ0FDO1lBQ0FHLGNBQWN1QztZQUNkZjtZQUNBYztZQUNBL0I7UUFDRjtRQUVBLE9BQU81QixxREFBWUEsQ0FBQ29FLElBQUksQ0FBQ0Q7SUFDM0IsRUFBRSxPQUFPRSxPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyxpREFBMkNBO1FBQ3pELE9BQU9yRSxxREFBWUEsQ0FBQ29FLElBQUksQ0FDdEI7WUFBRUMsT0FBTztRQUEyQixHQUNwQztZQUFFckQsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaWJsaW90ZWNhLWVzY29sYXIvLi9zcmMvYXBwL2FwaS9yZXBvcnRzL2xvYW5zL3JvdXRlLnRzPzg2M2QiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQgeyBMb2FuU2VydmljZSB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL2xvYW5zJ1xyXG5pbXBvcnQgeyBCb29rU2VydmljZSB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL2Jvb2tzJ1xyXG5pbXBvcnQgeyBTdHVkZW50U2VydmljZSB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL3N0dWRlbnRzJ1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcclxuICAgIGNvbnN0IHBlcmlvZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3BlcmlvZCcpIHx8ICdtZXMnXHJcblxyXG4gICAgLy8gQnVzY2FyIGVtcHLDqXN0aW1vcyBwb3IgcGVyw61vZG9cclxuICAgIGNvbnN0IGxvYW5zID0gYXdhaXQgTG9hblNlcnZpY2UuZ2V0TG9hbnNCeVBlcmlvZChwZXJpb2QpXHJcbiAgICBcclxuICAgIC8vIENhbGN1bGFyIGVzdGF0w61zdGljYXNcclxuICAgIGNvbnN0IHRvdGFsTG9hbnMgPSBsb2Fucy5sZW5ndGhcclxuICAgIGNvbnN0IGFjdGl2ZUxvYW5zID0gbG9hbnMuZmlsdGVyKGxvYW4gPT4gbG9hbi5zdGF0dXMgPT09ICdBQ1RJVkUnKS5sZW5ndGhcclxuICAgIGNvbnN0IHJldHVybmVkTG9hbnMgPSBsb2Fucy5maWx0ZXIobG9hbiA9PiBsb2FuLnN0YXR1cyA9PT0gJ1JFVFVSTkVEJykubGVuZ3RoXHJcbiAgICBjb25zdCBvdmVyZHVlTG9hbnMgPSBsb2Fucy5maWx0ZXIobG9hbiA9PiBcclxuICAgICAgbG9hbi5zdGF0dXMgPT09ICdBQ1RJVkUnICYmIG5ldyBEYXRlKGxvYW4uZHVlRGF0ZSkgPCBuZXcgRGF0ZSgpXHJcbiAgICApLmxlbmd0aFxyXG5cclxuICAgIC8vIEFncnVwYXIgcG9yIG3DqnNcclxuICAgIGNvbnN0IG1vbnRobHlMb2FucyA9IGxvYW5zLnJlZHVjZSgoYWNjOiBhbnksIGxvYW4pID0+IHtcclxuICAgICAgY29uc3QgbW9udGggPSBuZXcgRGF0ZShsb2FuLmJvcnJvd2VkQXQpLnRvTG9jYWxlRGF0ZVN0cmluZygncHQtQlInLCB7IG1vbnRoOiAnc2hvcnQnIH0pXHJcbiAgICAgIGlmICghYWNjW21vbnRoXSkge1xyXG4gICAgICAgIGFjY1ttb250aF0gPSB7IGxvYW5zOiAwLCByZXR1cm5zOiAwIH1cclxuICAgICAgfVxyXG4gICAgICBhY2NbbW9udGhdLmxvYW5zKytcclxuICAgICAgaWYgKGxvYW4uc3RhdHVzID09PSAnUkVUVVJORUQnKSB7XHJcbiAgICAgICAgYWNjW21vbnRoXS5yZXR1cm5zKytcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYWNjXHJcbiAgICB9LCB7fSlcclxuXHJcbiAgICAvLyBBZ3J1cGFyIHBvciBzZW1hbmEgKMO6bHRpbWFzIDQgc2VtYW5hcylcclxuICAgIGNvbnN0IGxvYW5UcmVuZHMgPSBbXVxyXG4gICAgZm9yIChsZXQgaSA9IDM7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgIGNvbnN0IHdlZWtTdGFydCA9IG5ldyBEYXRlKClcclxuICAgICAgd2Vla1N0YXJ0LnNldERhdGUod2Vla1N0YXJ0LmdldERhdGUoKSAtIChpICogNykpXHJcbiAgICAgIGNvbnN0IHdlZWtFbmQgPSBuZXcgRGF0ZSh3ZWVrU3RhcnQpXHJcbiAgICAgIHdlZWtFbmQuc2V0RGF0ZSh3ZWVrRW5kLmdldERhdGUoKSArIDYpXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB3ZWVrTG9hbnMgPSBsb2Fucy5maWx0ZXIobG9hbiA9PiB7XHJcbiAgICAgICAgY29uc3QgbG9hbkRhdGUgPSBuZXcgRGF0ZShsb2FuLmJvcnJvd2VkQXQpXHJcbiAgICAgICAgcmV0dXJuIGxvYW5EYXRlID49IHdlZWtTdGFydCAmJiBsb2FuRGF0ZSA8PSB3ZWVrRW5kXHJcbiAgICAgIH0pXHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB3ZWVrUmV0dXJucyA9IHdlZWtMb2Fucy5maWx0ZXIobG9hbiA9PiBsb2FuLnN0YXR1cyA9PT0gJ1JFVFVSTkVEJykubGVuZ3RoXHJcbiAgICAgIFxyXG4gICAgICBsb2FuVHJlbmRzLnB1c2goe1xyXG4gICAgICAgIHBlcmlvZDogYFNlbWFuYSAkezQgLSBpfWAsXHJcbiAgICAgICAgbG9hbnM6IHdlZWtMb2Fucy5sZW5ndGgsXHJcbiAgICAgICAgcmV0dXJuczogd2Vla1JldHVybnNcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBMaXZyb3MgbWFpcyBlbXByZXN0YWRvc1xyXG4gICAgY29uc3QgYm9va1N0YXRzID0gbG9hbnMucmVkdWNlKChhY2M6IGFueSwgbG9hbikgPT4ge1xyXG4gICAgICBjb25zdCBib29rVGl0bGUgPSBsb2FuLmJvb2sudGl0bGVcclxuICAgICAgY29uc3QgYm9va0NvZGUgPSBsb2FuLmJvb2suY29kZVxyXG4gICAgICBpZiAoIWFjY1tib29rVGl0bGVdKSB7XHJcbiAgICAgICAgYWNjW2Jvb2tUaXRsZV0gPSB7IFxyXG4gICAgICAgICAgdGl0bGU6IGJvb2tUaXRsZSxcclxuICAgICAgICAgIGNvZGU6IGJvb2tDb2RlLFxyXG4gICAgICAgICAgYXV0aG9yOiBsb2FuLmJvb2suYXV0aG9yLFxyXG4gICAgICAgICAgbG9hbnM6IDAsIFxyXG4gICAgICAgICAgcmV0dXJuczogMCBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgYWNjW2Jvb2tUaXRsZV0ubG9hbnMrK1xyXG4gICAgICBpZiAobG9hbi5zdGF0dXMgPT09ICdSRVRVUk5FRCcpIHtcclxuICAgICAgICBhY2NbYm9va1RpdGxlXS5yZXR1cm5zKytcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYWNjXHJcbiAgICB9LCB7fSlcclxuXHJcbiAgICBjb25zdCB0b3BMb2FuZWRCb29rcyA9IE9iamVjdC52YWx1ZXMoYm9va1N0YXRzKVxyXG4gICAgICAuc29ydCgoYTogYW55LCBiOiBhbnkpID0+IGIubG9hbnMgLSBhLmxvYW5zKVxyXG4gICAgICAuc2xpY2UoMCwgNSlcclxuXHJcbiAgICAvLyBNYWlvcmVzIHVzdcOhcmlvc1xyXG4gICAgY29uc3QgYm9ycm93ZXJTdGF0cyA9IGxvYW5zLnJlZHVjZSgoYWNjOiBhbnksIGxvYW4pID0+IHtcclxuICAgICAgY29uc3QgYm9ycm93ZXJOYW1lID0gbG9hbi5zdHVkZW50Lm5hbWVcclxuICAgICAgaWYgKCFhY2NbYm9ycm93ZXJOYW1lXSkge1xyXG4gICAgICAgIGFjY1tib3Jyb3dlck5hbWVdID0geyBcclxuICAgICAgICAgIG5hbWU6IGJvcnJvd2VyTmFtZSxcclxuICAgICAgICAgIHJlZ2lzdHJhdGlvbjogbG9hbi5zdHVkZW50LnJlZ2lzdHJhdGlvbixcclxuICAgICAgICAgIGdyYWRlOiBsb2FuLnN0dWRlbnQuZ3JhZGUsXHJcbiAgICAgICAgICBjbGFzczogbG9hbi5zdHVkZW50LmNsYXNzLFxyXG4gICAgICAgICAgbG9hbnM6IDAsIFxyXG4gICAgICAgICAgcmV0dXJuczogMCBcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgYWNjW2JvcnJvd2VyTmFtZV0ubG9hbnMrK1xyXG4gICAgICBpZiAobG9hbi5zdGF0dXMgPT09ICdSRVRVUk5FRCcpIHtcclxuICAgICAgICBhY2NbYm9ycm93ZXJOYW1lXS5yZXR1cm5zKytcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYWNjXHJcbiAgICB9LCB7fSlcclxuXHJcbiAgICBjb25zdCB0b3BCb3Jyb3dlcnMgPSBPYmplY3QudmFsdWVzKGJvcnJvd2VyU3RhdHMpXHJcbiAgICAgIC5zb3J0KChhOiBhbnksIGI6IGFueSkgPT4gYi5sb2FucyAtIGEubG9hbnMpXHJcbiAgICAgIC5zbGljZSgwLCA1KVxyXG5cclxuICAgIC8vIENvbnZlcnRlciBtb250aGx5TG9hbnMgcGFyYSBhcnJheVxyXG4gICAgY29uc3QgbW9udGhseUxvYW5zQXJyYXkgPSBPYmplY3QuZW50cmllcyhtb250aGx5TG9hbnMpXHJcbiAgICAgIC5tYXAoKFttb250aCwgc3RhdHNdOiBbc3RyaW5nLCBhbnldKSA9PiAoe1xyXG4gICAgICAgIG1vbnRoLFxyXG4gICAgICAgIGxvYW5zOiBzdGF0cy5sb2FucyxcclxuICAgICAgICByZXR1cm5zOiBzdGF0cy5yZXR1cm5zXHJcbiAgICAgIH0pKVxyXG4gICAgICAuc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICAgIGNvbnN0IG1vbnRocyA9IFsnamFuJywgJ2ZldicsICdtYXInLCAnYWJyJywgJ21haScsICdqdW4nLCAnanVsJywgJ2FnbycsICdzZXQnLCAnb3V0JywgJ25vdicsICdkZXonXVxyXG4gICAgICAgIHJldHVybiBtb250aHMuaW5kZXhPZihhLm1vbnRoLnRvTG93ZXJDYXNlKCkpIC0gbW9udGhzLmluZGV4T2YoYi5tb250aC50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICB9KVxyXG5cclxuICAgIGNvbnN0IHJlcG9ydERhdGEgPSB7XHJcbiAgICAgIHRvdGFsTG9hbnMsXHJcbiAgICAgIGFjdGl2ZUxvYW5zLFxyXG4gICAgICByZXR1cm5lZExvYW5zLFxyXG4gICAgICBvdmVyZHVlTG9hbnMsXHJcbiAgICAgIG1vbnRobHlMb2FuczogbW9udGhseUxvYW5zQXJyYXksXHJcbiAgICAgIHRvcExvYW5lZEJvb2tzLFxyXG4gICAgICB0b3BCb3Jyb3dlcnMsXHJcbiAgICAgIGxvYW5UcmVuZHNcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVwb3J0RGF0YSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBnZXJhciByZWxhdMOzcmlvIGRlIGVtcHLDqXN0aW1vczonLCBlcnJvcilcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0Vycm8gaW50ZXJubyBkbyBzZXJ2aWRvcicgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApXHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJMb2FuU2VydmljZSIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJwZXJpb2QiLCJnZXQiLCJsb2FucyIsImdldExvYW5zQnlQZXJpb2QiLCJ0b3RhbExvYW5zIiwibGVuZ3RoIiwiYWN0aXZlTG9hbnMiLCJmaWx0ZXIiLCJsb2FuIiwic3RhdHVzIiwicmV0dXJuZWRMb2FucyIsIm92ZXJkdWVMb2FucyIsIkRhdGUiLCJkdWVEYXRlIiwibW9udGhseUxvYW5zIiwicmVkdWNlIiwiYWNjIiwibW9udGgiLCJib3Jyb3dlZEF0IiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicmV0dXJucyIsImxvYW5UcmVuZHMiLCJpIiwid2Vla1N0YXJ0Iiwic2V0RGF0ZSIsImdldERhdGUiLCJ3ZWVrRW5kIiwid2Vla0xvYW5zIiwibG9hbkRhdGUiLCJ3ZWVrUmV0dXJucyIsInB1c2giLCJib29rU3RhdHMiLCJib29rVGl0bGUiLCJib29rIiwidGl0bGUiLCJib29rQ29kZSIsImNvZGUiLCJhdXRob3IiLCJ0b3BMb2FuZWRCb29rcyIsIk9iamVjdCIsInZhbHVlcyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwiYm9ycm93ZXJTdGF0cyIsImJvcnJvd2VyTmFtZSIsInN0dWRlbnQiLCJuYW1lIiwicmVnaXN0cmF0aW9uIiwiZ3JhZGUiLCJjbGFzcyIsInRvcEJvcnJvd2VycyIsIm1vbnRobHlMb2Fuc0FycmF5IiwiZW50cmllcyIsIm1hcCIsInN0YXRzIiwibW9udGhzIiwiaW5kZXhPZiIsInRvTG93ZXJDYXNlIiwicmVwb3J0RGF0YSIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/reports/loans/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsR0FBRTtBQUVsRSxJQUFJSSxJQUF5QixFQUFjSCxnQkFBZ0JFLE1BQU0sR0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaWJsaW90ZWNhLWVzY29sYXIvLi9zcmMvbGliL3ByaXNtYS50cz8wMWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcclxuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KClcclxuXHJcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hICJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/audit.ts":
/*!***********************************!*\
  !*** ./src/lib/services/audit.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuditService: () => (/* binding */ AuditService)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../prisma */ \"(rsc)/./src/lib/prisma.ts\");\n\nclass AuditService {\n    // Criar log de auditoria\n    static async createAuditLog(data) {\n        // Verificar se já existe um log similar recente (últimos 5 segundos) para evitar duplicatas\n        const recentLog = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.findFirst({\n            where: {\n                bookId: data.bookId,\n                action: data.action,\n                description: data.description,\n                createdAt: {\n                    gte: new Date(Date.now() - 5000) // Últimos 5 segundos\n                }\n            }\n        });\n        if (recentLog) {\n            console.log(\"Log similar j\\xe1 existe, evitando duplicata:\", data.description);\n            return recentLog;\n        }\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.create({\n            data,\n            include: {\n                book: {\n                    select: {\n                        code: true,\n                        title: true\n                    }\n                }\n            }\n        });\n    }\n    // Buscar logs de auditoria por livro\n    static async getAuditLogsByBook(bookId) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.findMany({\n            where: {\n                bookId\n            },\n            include: {\n                book: {\n                    select: {\n                        code: true,\n                        title: true\n                    }\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            }\n        });\n    }\n    // Buscar todos os logs de auditoria\n    static async getAllAuditLogs(limit = 100) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.findMany({\n            include: {\n                book: {\n                    select: {\n                        code: true,\n                        title: true\n                    }\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: limit\n        });\n    }\n    // Buscar logs por ação\n    static async getAuditLogsByAction(action, limit = 50) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.findMany({\n            where: {\n                action\n            },\n            include: {\n                book: {\n                    select: {\n                        code: true,\n                        title: true\n                    }\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            },\n            take: limit\n        });\n    }\n    // Buscar logs por período\n    static async getAuditLogsByPeriod(startDate, endDate) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.findMany({\n            where: {\n                createdAt: {\n                    gte: startDate,\n                    lte: endDate\n                }\n            },\n            include: {\n                book: {\n                    select: {\n                        code: true,\n                        title: true\n                    }\n                }\n            },\n            orderBy: {\n                createdAt: \"desc\"\n            }\n        });\n    }\n    // Buscar estatísticas de auditoria\n    static async getAuditStats() {\n        const totalLogs = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.count();\n        const logsByAction = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.groupBy({\n            by: [\n                \"action\"\n            ],\n            _count: {\n                action: true\n            }\n        });\n        const recentLogs = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.bookAuditLog.count({\n            where: {\n                createdAt: {\n                    gte: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000) // Últimos 30 dias\n                }\n            }\n        });\n        return {\n            totalLogs,\n            recentLogs,\n            logsByAction: logsByAction.map((log)=>({\n                    action: log.action,\n                    count: log._count.action\n                }))\n        };\n    }\n    // Log de criação de livro\n    static async logBookCreation(bookId, bookData, userId) {\n        return await this.createAuditLog({\n            bookId,\n            action: \"CREATE\",\n            description: `Livro \"${bookData.title}\" (${bookData.code}) foi cadastrado no sistema`,\n            userId\n        });\n    }\n    // Log de atualização de livro\n    static async logBookUpdate(bookId, fieldName, oldValue, newValue, userId) {\n        const book = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findUnique({\n            where: {\n                id: bookId\n            },\n            select: {\n                code: true,\n                title: true\n            }\n        });\n        return await this.createAuditLog({\n            bookId,\n            action: \"UPDATE\",\n            fieldName,\n            oldValue: String(oldValue),\n            newValue: String(newValue),\n            description: `Campo \"${fieldName}\" do livro \"${book?.title}\" (${book?.code}) foi alterado`,\n            userId\n        });\n    }\n    // Log de exclusão de livro\n    static async logBookDeletion(bookId, bookData, userId) {\n        return await this.createAuditLog({\n            bookId,\n            action: \"DELETE\",\n            description: `Livro \"${bookData.title}\" (${bookData.code}) foi removido do sistema`,\n            userId\n        });\n    }\n    // Log de restauração de livro\n    static async logBookRestoration(bookId, bookData, userId) {\n        return await this.createAuditLog({\n            bookId,\n            action: \"RESTORE\",\n            description: `Livro \"${bookData.title}\" (${bookData.code}) foi restaurado no sistema`,\n            userId\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWMsQ0FBQztZQUMxRndCO1FBQ0Y7SUFDRjtJQUVBLDJCQUEyQjtJQUMzQixhQUFhUSxnQkFBZ0I3QyxNQUFjLEVBQUVvQyxRQUFhLEVBQUVDLE1BQWUsRUFBRTtRQUMzRSxPQUFPLE1BQU0sSUFBSSxDQUFDM0MsY0FBYyxDQUFDO1lBQy9CTTtZQUNBQyxRQUFRO1lBQ1JDLGFBQWEsQ0FBQyxPQUFPLEVBQUVrQyxTQUFTdEIsS0FBSyxDQUFDLEdBQUcsRUFBRXNCLFNBQVN2QixJQUFJLENBQUMseUJBQXlCLENBQUM7WUFDbkZ3QjtRQUNGO0lBQ0Y7SUFFQSw4QkFBOEI7SUFDOUIsYUFBYVMsbUJBQW1COUMsTUFBYyxFQUFFb0MsUUFBYSxFQUFFQyxNQUFlLEVBQUU7UUFDOUUsT0FBTyxNQUFNLElBQUksQ0FBQzNDLGNBQWMsQ0FBQztZQUMvQk07WUFDQUMsUUFBUTtZQUNSQyxhQUFhLENBQUMsT0FBTyxFQUFFa0MsU0FBU3RCLEtBQUssQ0FBQyxHQUFHLEVBQUVzQixTQUFTdkIsSUFBSSxDQUFDLDJCQUEyQixDQUFDO1lBQ3JGd0I7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iaWJsaW90ZWNhLWVzY29sYXIvLi9zcmMvbGliL3NlcnZpY2VzL2F1ZGl0LnRzPzUyMTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi4vcHJpc21hJ1xyXG5cclxudHlwZSBBdWRpdEFjdGlvbiA9ICdDUkVBVEUnIHwgJ1VQREFURScgfCAnREVMRVRFJyB8ICdSRVNUT1JFJ1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVBdWRpdExvZ0RhdGEge1xyXG4gIGJvb2tJZDogc3RyaW5nXHJcbiAgYWN0aW9uOiBBdWRpdEFjdGlvblxyXG4gIGZpZWxkTmFtZT86IHN0cmluZ1xyXG4gIG9sZFZhbHVlPzogc3RyaW5nXHJcbiAgbmV3VmFsdWU/OiBzdHJpbmdcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nXHJcbiAgdXNlcklkPzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBBdWRpdFNlcnZpY2Uge1xyXG4gIC8vIENyaWFyIGxvZyBkZSBhdWRpdG9yaWFcclxuICBzdGF0aWMgYXN5bmMgY3JlYXRlQXVkaXRMb2coZGF0YTogQ3JlYXRlQXVkaXRMb2dEYXRhKSB7XHJcbiAgICAvLyBWZXJpZmljYXIgc2UgasOhIGV4aXN0ZSB1bSBsb2cgc2ltaWxhciByZWNlbnRlICjDumx0aW1vcyA1IHNlZ3VuZG9zKSBwYXJhIGV2aXRhciBkdXBsaWNhdGFzXHJcbiAgICBjb25zdCByZWNlbnRMb2cgPSBhd2FpdCAocHJpc21hIGFzIGFueSkuYm9va0F1ZGl0TG9nLmZpbmRGaXJzdCh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgYm9va0lkOiBkYXRhLmJvb2tJZCxcclxuICAgICAgICBhY3Rpb246IGRhdGEuYWN0aW9uLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBkYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICAgIGNyZWF0ZWRBdDoge1xyXG4gICAgICAgICAgZ3RlOiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gNTAwMCkgLy8gw5psdGltb3MgNSBzZWd1bmRvc1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAocmVjZW50TG9nKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdMb2cgc2ltaWxhciBqw6EgZXhpc3RlLCBldml0YW5kbyBkdXBsaWNhdGE6JywgZGF0YS5kZXNjcmlwdGlvbilcclxuICAgICAgcmV0dXJuIHJlY2VudExvZ1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhd2FpdCAocHJpc21hIGFzIGFueSkuYm9va0F1ZGl0TG9nLmNyZWF0ZSh7XHJcbiAgICAgIGRhdGEsXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBib29rOiB7XHJcbiAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgY29kZTogdHJ1ZSxcclxuICAgICAgICAgICAgdGl0bGU6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgbG9ncyBkZSBhdWRpdG9yaWEgcG9yIGxpdnJvXHJcbiAgc3RhdGljIGFzeW5jIGdldEF1ZGl0TG9nc0J5Qm9vayhib29rSWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGF3YWl0IChwcmlzbWEgYXMgYW55KS5ib29rQXVkaXRMb2cuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBib29rSWQgfSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGJvb2s6IHtcclxuICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICBjb2RlOiB0cnVlLFxyXG4gICAgICAgICAgICB0aXRsZTogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gQnVzY2FyIHRvZG9zIG9zIGxvZ3MgZGUgYXVkaXRvcmlhXHJcbiAgc3RhdGljIGFzeW5jIGdldEFsbEF1ZGl0TG9ncyhsaW1pdDogbnVtYmVyID0gMTAwKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgKHByaXNtYSBhcyBhbnkpLmJvb2tBdWRpdExvZy5maW5kTWFueSh7XHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBib29rOiB7XHJcbiAgICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgICAgY29kZTogdHJ1ZSxcclxuICAgICAgICAgICAgdGl0bGU6IHRydWVcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcclxuICAgICAgdGFrZTogbGltaXRcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgbG9ncyBwb3IgYcOnw6NvXHJcbiAgc3RhdGljIGFzeW5jIGdldEF1ZGl0TG9nc0J5QWN0aW9uKGFjdGlvbjogQXVkaXRBY3Rpb24sIGxpbWl0OiBudW1iZXIgPSA1MCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IChwcmlzbWEgYXMgYW55KS5ib29rQXVkaXRMb2cuZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBhY3Rpb24gfSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGJvb2s6IHtcclxuICAgICAgICAgIHNlbGVjdDoge1xyXG4gICAgICAgICAgICBjb2RlOiB0cnVlLFxyXG4gICAgICAgICAgICB0aXRsZTogdHJ1ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxyXG4gICAgICB0YWtlOiBsaW1pdFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIEJ1c2NhciBsb2dzIHBvciBwZXLDrW9kb1xyXG4gIHN0YXRpYyBhc3luYyBnZXRBdWRpdExvZ3NCeVBlcmlvZChzdGFydERhdGU6IERhdGUsIGVuZERhdGU6IERhdGUpIHtcclxuICAgIHJldHVybiBhd2FpdCAocHJpc21hIGFzIGFueSkuYm9va0F1ZGl0TG9nLmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgIGd0ZTogc3RhcnREYXRlLFxyXG4gICAgICAgICAgbHRlOiBlbmREYXRlXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgYm9vazoge1xyXG4gICAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICAgIGNvZGU6IHRydWUsXHJcbiAgICAgICAgICAgIHRpdGxlOiB0cnVlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgZXN0YXTDrXN0aWNhcyBkZSBhdWRpdG9yaWFcclxuICBzdGF0aWMgYXN5bmMgZ2V0QXVkaXRTdGF0cygpIHtcclxuICAgIGNvbnN0IHRvdGFsTG9ncyA9IGF3YWl0IChwcmlzbWEgYXMgYW55KS5ib29rQXVkaXRMb2cuY291bnQoKVxyXG4gICAgXHJcbiAgICBjb25zdCBsb2dzQnlBY3Rpb24gPSBhd2FpdCAocHJpc21hIGFzIGFueSkuYm9va0F1ZGl0TG9nLmdyb3VwQnkoe1xyXG4gICAgICBieTogWydhY3Rpb24nXSxcclxuICAgICAgX2NvdW50OiB7IGFjdGlvbjogdHJ1ZSB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IHJlY2VudExvZ3MgPSBhd2FpdCAocHJpc21hIGFzIGFueSkuYm9va0F1ZGl0TG9nLmNvdW50KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBjcmVhdGVkQXQ6IHtcclxuICAgICAgICAgIGd0ZTogbmV3IERhdGUoRGF0ZS5ub3coKSAtIDMwICogMjQgKiA2MCAqIDYwICogMTAwMCkgLy8gw5psdGltb3MgMzAgZGlhc1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0b3RhbExvZ3MsXHJcbiAgICAgIHJlY2VudExvZ3MsXHJcbiAgICAgIGxvZ3NCeUFjdGlvbjogbG9nc0J5QWN0aW9uLm1hcCgobG9nOiBhbnkpID0+ICh7XHJcbiAgICAgICAgYWN0aW9uOiBsb2cuYWN0aW9uLFxyXG4gICAgICAgIGNvdW50OiBsb2cuX2NvdW50LmFjdGlvblxyXG4gICAgICB9KSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIExvZyBkZSBjcmlhw6fDo28gZGUgbGl2cm9cclxuICBzdGF0aWMgYXN5bmMgbG9nQm9va0NyZWF0aW9uKGJvb2tJZDogc3RyaW5nLCBib29rRGF0YTogYW55LCB1c2VySWQ/OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLmNyZWF0ZUF1ZGl0TG9nKHtcclxuICAgICAgYm9va0lkLFxyXG4gICAgICBhY3Rpb246ICdDUkVBVEUnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYExpdnJvIFwiJHtib29rRGF0YS50aXRsZX1cIiAoJHtib29rRGF0YS5jb2RlfSkgZm9pIGNhZGFzdHJhZG8gbm8gc2lzdGVtYWAsXHJcbiAgICAgIHVzZXJJZFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIExvZyBkZSBhdHVhbGl6YcOnw6NvIGRlIGxpdnJvXHJcbiAgc3RhdGljIGFzeW5jIGxvZ0Jvb2tVcGRhdGUoYm9va0lkOiBzdHJpbmcsIGZpZWxkTmFtZTogc3RyaW5nLCBvbGRWYWx1ZTogYW55LCBuZXdWYWx1ZTogYW55LCB1c2VySWQ/OiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGJvb2sgPSBhd2FpdCAocHJpc21hIGFzIGFueSkuYm9vay5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQ6IGJvb2tJZCB9LFxyXG4gICAgICBzZWxlY3Q6IHsgY29kZTogdHJ1ZSwgdGl0bGU6IHRydWUgfVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5jcmVhdGVBdWRpdExvZyh7XHJcbiAgICAgIGJvb2tJZCxcclxuICAgICAgYWN0aW9uOiAnVVBEQVRFJyxcclxuICAgICAgZmllbGROYW1lLFxyXG4gICAgICBvbGRWYWx1ZTogU3RyaW5nKG9sZFZhbHVlKSxcclxuICAgICAgbmV3VmFsdWU6IFN0cmluZyhuZXdWYWx1ZSksXHJcbiAgICAgIGRlc2NyaXB0aW9uOiBgQ2FtcG8gXCIke2ZpZWxkTmFtZX1cIiBkbyBsaXZybyBcIiR7Ym9vaz8udGl0bGV9XCIgKCR7Ym9vaz8uY29kZX0pIGZvaSBhbHRlcmFkb2AsXHJcbiAgICAgIHVzZXJJZFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIExvZyBkZSBleGNsdXPDo28gZGUgbGl2cm9cclxuICBzdGF0aWMgYXN5bmMgbG9nQm9va0RlbGV0aW9uKGJvb2tJZDogc3RyaW5nLCBib29rRGF0YTogYW55LCB1c2VySWQ/OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBhd2FpdCB0aGlzLmNyZWF0ZUF1ZGl0TG9nKHtcclxuICAgICAgYm9va0lkLFxyXG4gICAgICBhY3Rpb246ICdERUxFVEUnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYExpdnJvIFwiJHtib29rRGF0YS50aXRsZX1cIiAoJHtib29rRGF0YS5jb2RlfSkgZm9pIHJlbW92aWRvIGRvIHNpc3RlbWFgLFxyXG4gICAgICB1c2VySWRcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBMb2cgZGUgcmVzdGF1cmHDp8OjbyBkZSBsaXZyb1xyXG4gIHN0YXRpYyBhc3luYyBsb2dCb29rUmVzdG9yYXRpb24oYm9va0lkOiBzdHJpbmcsIGJvb2tEYXRhOiBhbnksIHVzZXJJZD86IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuY3JlYXRlQXVkaXRMb2coe1xyXG4gICAgICBib29rSWQsXHJcbiAgICAgIGFjdGlvbjogJ1JFU1RPUkUnLFxyXG4gICAgICBkZXNjcmlwdGlvbjogYExpdnJvIFwiJHtib29rRGF0YS50aXRsZX1cIiAoJHtib29rRGF0YS5jb2RlfSkgZm9pIHJlc3RhdXJhZG8gbm8gc2lzdGVtYWAsXHJcbiAgICAgIHVzZXJJZFxyXG4gICAgfSlcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbInByaXNtYSIsIkF1ZGl0U2VydmljZSIsImNyZWF0ZUF1ZGl0TG9nIiwiZGF0YSIsInJlY2VudExvZyIsImJvb2tBdWRpdExvZyIsImZpbmRGaXJzdCIsIndoZXJlIiwiYm9va0lkIiwiYWN0aW9uIiwiZGVzY3JpcHRpb24iLCJjcmVhdGVkQXQiLCJndGUiLCJEYXRlIiwibm93IiwiY29uc29sZSIsImxvZyIsImNyZWF0ZSIsImluY2x1ZGUiLCJib29rIiwic2VsZWN0IiwiY29kZSIsInRpdGxlIiwiZ2V0QXVkaXRMb2dzQnlCb29rIiwiZmluZE1hbnkiLCJvcmRlckJ5IiwiZ2V0QWxsQXVkaXRMb2dzIiwibGltaXQiLCJ0YWtlIiwiZ2V0QXVkaXRMb2dzQnlBY3Rpb24iLCJnZXRBdWRpdExvZ3NCeVBlcmlvZCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJsdGUiLCJnZXRBdWRpdFN0YXRzIiwidG90YWxMb2dzIiwiY291bnQiLCJsb2dzQnlBY3Rpb24iLCJncm91cEJ5IiwiYnkiLCJfY291bnQiLCJyZWNlbnRMb2dzIiwibWFwIiwibG9nQm9va0NyZWF0aW9uIiwiYm9va0RhdGEiLCJ1c2VySWQiLCJsb2dCb29rVXBkYXRlIiwiZmllbGROYW1lIiwib2xkVmFsdWUiLCJuZXdWYWx1ZSIsImZpbmRVbmlxdWUiLCJpZCIsIlN0cmluZyIsImxvZ0Jvb2tEZWxldGlvbiIsImxvZ0Jvb2tSZXN0b3JhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/audit.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/books.ts":
/*!***********************************!*\
  !*** ./src/lib/services/books.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BookService: () => (/* binding */ BookService)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _audit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./audit */ \"(rsc)/./src/lib/services/audit.ts\");\n\n\nclass BookService {\n    // Gerar código automático para o livro\n    static async generateBookCode(genre) {\n        const currentYear = new Date().getFullYear().toString().slice(-2) // Últimos 2 dígitos do ano\n        ;\n        // Buscar o último código usado para este ano\n        const lastBook = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findFirst({\n            where: {\n                code: {\n                    contains: `/${currentYear}-`\n                },\n                deletedAt: null\n            },\n            orderBy: {\n                code: \"desc\"\n            }\n        });\n        let nextNumber = 1;\n        if (lastBook) {\n            const lastNumber = parseInt(lastBook.code.split(\"/\")[0]);\n            nextNumber = lastNumber + 1;\n        }\n        // Abreviação do gênero (primeiras 3 letras)\n        const genreAbbreviation = genre.substring(0, 3).toUpperCase();\n        return `${nextNumber.toString().padStart(4, \"0\")}/${currentYear}-${genreAbbreviation}`;\n    }\n    // Buscar todos os livros (apenas ativos)\n    static async getAllBooks() {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            where: {\n                deletedAt: null\n            },\n            orderBy: {\n                title: \"asc\"\n            }\n        });\n    }\n    // Buscar todos os livros (incluindo deletados)\n    static async getAllBooksWithDeleted() {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            orderBy: {\n                title: \"asc\"\n            }\n        });\n    }\n    // Buscar apenas livros deletados\n    static async getDeletedBooks() {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            where: {\n                deletedAt: {\n                    not: null\n                }\n            },\n            orderBy: {\n                deletedAt: \"desc\"\n            }\n        });\n    }\n    // Buscar livro por ID (apenas ativos)\n    static async getBookById(id) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findFirst({\n            where: {\n                id,\n                deletedAt: null\n            }\n        });\n    }\n    // Buscar livro por ID (incluindo deletados)\n    static async getBookByIdWithDeleted(id) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findUnique({\n            where: {\n                id\n            }\n        });\n    }\n    // Buscar livros por filtros (apenas ativos)\n    static async getBooksByFilters(filters) {\n        const { search, status, genre } = filters;\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            where: {\n                AND: [\n                    {\n                        deletedAt: null\n                    },\n                    search ? {\n                        OR: [\n                            {\n                                title: {\n                                    contains: search\n                                }\n                            },\n                            {\n                                author: {\n                                    contains: search\n                                }\n                            },\n                            {\n                                code: {\n                                    contains: search\n                                }\n                            },\n                            {\n                                isbn: {\n                                    contains: search\n                                }\n                            }\n                        ]\n                    } : {},\n                    genre ? {\n                        genre\n                    } : {},\n                    status === \"dispon\\xedvel\" ? {\n                        currentQuantity: {\n                            gt: 0\n                        }\n                    } : {},\n                    status === \"emprestado\" ? {\n                        currentQuantity: {\n                            equals: 0\n                        }\n                    } : {}\n                ]\n            },\n            orderBy: {\n                title: \"asc\"\n            }\n        });\n    }\n    // Criar novo livro\n    static async createBook(data, userId) {\n        try {\n            const code = await this.generateBookCode(data.genre);\n            const book = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.create({\n                data: {\n                    ...data,\n                    code,\n                    quantity: data.quantity || 1,\n                    currentQuantity: data.quantity || 1,\n                    loansCount: 0\n                }\n            });\n            // Log de auditoria\n            await _audit__WEBPACK_IMPORTED_MODULE_1__.AuditService.logBookCreation(book.id, book, userId);\n            return book;\n        } catch (error) {\n            // Verificar se é erro de constraint única\n            if (error.code === \"P2002\") {\n                if (error.meta?.target?.includes(\"isbn\")) {\n                    throw new Error(\"ISBN j\\xe1 existe no sistema. Por favor, use um ISBN diferente.\");\n                }\n                if (error.meta?.target?.includes(\"code\")) {\n                    throw new Error(\"C\\xf3digo do livro j\\xe1 existe. Tente novamente.\");\n                }\n                throw new Error(\"Dados duplicados. Verifique se o livro j\\xe1 existe.\");\n            }\n            throw error;\n        }\n    }\n    // Atualizar livro\n    static async updateBook(id, data, userId) {\n        try {\n            // Buscar dados atuais do livro para comparação\n            const currentBook = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findUnique({\n                where: {\n                    id,\n                    deletedAt: null\n                }\n            });\n            if (!currentBook) {\n                throw new Error(\"Livro n\\xe3o encontrado\");\n            }\n            // Realizar a atualização\n            const updatedBook = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.update({\n                where: {\n                    id,\n                    deletedAt: null\n                },\n                data\n            });\n            // Log de auditoria para campos alterados (com try/catch para não falhar a atualização)\n            try {\n                const changedFields = [];\n                for (const [field, newValue] of Object.entries(data)){\n                    // Ignorar campos que não devem gerar logs\n                    if (field === \"updatedAt\" || field === \"createdAt\" || field === \"deletedAt\") {\n                        continue;\n                    }\n                    const oldValue = currentBook[field];\n                    // Comparar valores convertendo para string para evitar logs desnecessários\n                    if (String(oldValue) !== String(newValue)) {\n                        changedFields.push(field);\n                        await _audit__WEBPACK_IMPORTED_MODULE_1__.AuditService.logBookUpdate(id, field, oldValue, newValue, userId);\n                    }\n                }\n                // Se nenhum campo foi alterado, não criar log\n                if (changedFields.length === 0) {\n                    console.log(\"Nenhum campo foi alterado no livro:\", id);\n                }\n            } catch (auditError) {\n                console.error(\"Erro ao criar log de auditoria:\", auditError);\n            // Não falhar a atualização por causa do log\n            }\n            return updatedBook;\n        } catch (error) {\n            console.error(\"Erro no updateBook:\", error);\n            throw error;\n        }\n    }\n    // Soft delete - marcar como deletado\n    static async softDeleteBook(id, userId) {\n        try {\n            // Buscar dados do livro antes da deleção para o log\n            const bookData = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findUnique({\n                where: {\n                    id\n                }\n            });\n            if (!bookData) {\n                throw new Error(\"Livro n\\xe3o encontrado\");\n            }\n            // Realizar o soft delete\n            const deletedBook = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.update({\n                where: {\n                    id,\n                    deletedAt: null\n                },\n                data: {\n                    deletedAt: new Date()\n                }\n            });\n            // Log de auditoria (com try/catch para não falhar a deleção)\n            try {\n                await _audit__WEBPACK_IMPORTED_MODULE_1__.AuditService.logBookDeletion(id, bookData, userId);\n            } catch (auditError) {\n                console.error(\"Erro ao criar log de auditoria:\", auditError);\n            // Não falhar a deleção por causa do log\n            }\n            return deletedBook;\n        } catch (error) {\n            console.error(\"Erro no softDeleteBook:\", error);\n            throw error;\n        }\n    }\n    // Restaurar livro deletado\n    static async restoreBook(id) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.update({\n            where: {\n                id,\n                deletedAt: {\n                    not: null\n                }\n            },\n            data: {\n                deletedAt: null\n            }\n        });\n    }\n    // Hard delete - excluir permanentemente\n    static async hardDeleteBook(id) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.delete({\n            where: {\n                id\n            }\n        });\n    }\n    // Buscar estatísticas de livros (apenas ativos)\n    static async getBookStats() {\n        const totalBooks = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.count({\n            where: {\n                deletedAt: null\n            }\n        });\n        console.log(totalBooks);\n        // Calcular livros disponíveis (soma de todos os exemplares disponíveis)\n        const booksWithAvailability = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            where: {\n                deletedAt: null\n            },\n            select: {\n                currentQuantity: true\n            }\n        });\n        const availableBooks = booksWithAvailability.reduce((sum, book)=>sum + book.currentQuantity, 0);\n        // Calcular livros emprestados (empréstimos ativos)\n        const activeLoans = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.count({\n            where: {\n                status: \"ACTIVE\"\n            }\n        });\n        const genres = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.groupBy({\n            by: [\n                \"genre\"\n            ],\n            where: {\n                deletedAt: null\n            },\n            _count: {\n                genre: true\n            }\n        });\n        const booksByYear = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.groupBy({\n            by: [\n                \"year\"\n            ],\n            where: {\n                year: {\n                    not: null\n                },\n                deletedAt: null\n            },\n            _count: {\n                year: true\n            }\n        });\n        return {\n            totalBooks,\n            availableBooks,\n            borrowedBooks: activeLoans,\n            genres: genres.map((genre)=>({\n                    genre: genre.genre,\n                    count: genre._count.genre\n                })),\n            booksByYear: booksByYear.map((year)=>({\n                    year: year.year,\n                    count: year._count.year\n                }))\n        };\n    }\n    // Buscar livros mais emprestados (apenas ativos)\n    static async getTopBooks(limit = 5) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            where: {\n                deletedAt: null\n            },\n            take: limit,\n            orderBy: {\n                loansCount: \"desc\"\n            }\n        });\n    }\n    // Incrementar contador de empréstimos\n    static async incrementLoansCount(bookId) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.update({\n            where: {\n                id: bookId,\n                deletedAt: null\n            },\n            data: {\n                loansCount: {\n                    increment: 1\n                },\n                currentQuantity: {\n                    decrement: 1\n                }\n            }\n        });\n    }\n    // Decrementar contador de empréstimos (quando livro é devolvido)\n    static async decrementLoansCount(bookId) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.update({\n            where: {\n                id: bookId,\n                deletedAt: null\n            },\n            data: {\n                currentQuantity: {\n                    increment: 1\n                }\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDYjtZQUNBZ0MsTUFBTTtnQkFDSkosaUJBQWlCO29CQUNmOEQsV0FBVztnQkFDYjtZQUNGO1FBQ0Y7SUFDRjtBQUdGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmlibGlvdGVjYS1lc2NvbGFyLy4vc3JjL2xpYi9zZXJ2aWNlcy9ib29rcy50cz8zZTZlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gJy4uL3ByaXNtYSdcclxuaW1wb3J0IHsgQm9vayB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xyXG5pbXBvcnQgeyBBdWRpdFNlcnZpY2UgfSBmcm9tICcuL2F1ZGl0J1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVCb29rRGF0YSB7XHJcbiAgdGl0bGU6IHN0cmluZ1xyXG4gIGF1dGhvcjogc3RyaW5nXHJcbiAgcHVibGlzaGVyOiBzdHJpbmdcclxuICBnZW5yZTogc3RyaW5nXHJcbiAgZW50cnlEYXRlOiBEYXRlXHJcbiAgcXVhbnRpdHk6IG51bWJlclxyXG4gIGlzYm4/OiBzdHJpbmdcclxuICB5ZWFyPzogbnVtYmVyXHJcbiAgbG9jYXRpb24/OiBzdHJpbmdcclxuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZUJvb2tEYXRhIGV4dGVuZHMgUGFydGlhbDxDcmVhdGVCb29rRGF0YT4ge31cclxuXHJcbmV4cG9ydCBjbGFzcyBCb29rU2VydmljZSB7XHJcbiAgLy8gR2VyYXIgY8OzZGlnbyBhdXRvbcOhdGljbyBwYXJhIG8gbGl2cm9cclxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBnZW5lcmF0ZUJvb2tDb2RlKGdlbnJlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgY29uc3QgY3VycmVudFllYXIgPSBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKS5zbGljZSgtMikgLy8gw5psdGltb3MgMiBkw61naXRvcyBkbyBhbm9cclxuICAgIFxyXG4gICAgLy8gQnVzY2FyIG8gw7psdGltbyBjw7NkaWdvIHVzYWRvIHBhcmEgZXN0ZSBhbm9cclxuICAgIGNvbnN0IGxhc3RCb29rID0gYXdhaXQgcHJpc21hLmJvb2suZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBjb2RlOiB7XHJcbiAgICAgICAgICBjb250YWluczogYC8ke2N1cnJlbnRZZWFyfS1gXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkZWxldGVkQXQ6IG51bGxcclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeToge1xyXG4gICAgICAgIGNvZGU6ICdkZXNjJ1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGxldCBuZXh0TnVtYmVyID0gMVxyXG4gICAgaWYgKGxhc3RCb29rKSB7XHJcbiAgICAgIGNvbnN0IGxhc3ROdW1iZXIgPSBwYXJzZUludChsYXN0Qm9vay5jb2RlLnNwbGl0KCcvJylbMF0pXHJcbiAgICAgIG5leHROdW1iZXIgPSBsYXN0TnVtYmVyICsgMVxyXG4gICAgfVxyXG5cclxuICAgIC8vIEFicmV2aWHDp8OjbyBkbyBnw6puZXJvIChwcmltZWlyYXMgMyBsZXRyYXMpXHJcbiAgICBjb25zdCBnZW5yZUFiYnJldmlhdGlvbiA9IGdlbnJlLnN1YnN0cmluZygwLCAzKS50b1VwcGVyQ2FzZSgpXHJcbiAgICBcclxuICAgIHJldHVybiBgJHtuZXh0TnVtYmVyLnRvU3RyaW5nKCkucGFkU3RhcnQoNCwgJzAnKX0vJHtjdXJyZW50WWVhcn0tJHtnZW5yZUFiYnJldmlhdGlvbn1gXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgdG9kb3Mgb3MgbGl2cm9zIChhcGVuYXMgYXRpdm9zKVxyXG4gIHN0YXRpYyBhc3luYyBnZXRBbGxCb29rcygpIHtcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgZGVsZXRlZEF0OiBudWxsXHJcbiAgICAgIH0sXHJcbiAgICAgIG9yZGVyQnk6IHsgdGl0bGU6ICdhc2MnIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgdG9kb3Mgb3MgbGl2cm9zIChpbmNsdWluZG8gZGVsZXRhZG9zKVxyXG4gIHN0YXRpYyBhc3luYyBnZXRBbGxCb29rc1dpdGhEZWxldGVkKCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IHByaXNtYS5ib29rLmZpbmRNYW55KHtcclxuICAgICAgb3JkZXJCeTogeyB0aXRsZTogJ2FzYycgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIEJ1c2NhciBhcGVuYXMgbGl2cm9zIGRlbGV0YWRvc1xyXG4gIHN0YXRpYyBhc3luYyBnZXREZWxldGVkQm9va3MoKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcHJpc21hLmJvb2suZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZToge1xyXG4gICAgICAgIGRlbGV0ZWRBdDoge1xyXG4gICAgICAgICAgbm90OiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBvcmRlckJ5OiB7IGRlbGV0ZWRBdDogJ2Rlc2MnIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgbGl2cm8gcG9yIElEIChhcGVuYXMgYXRpdm9zKVxyXG4gIHN0YXRpYyBhc3luYyBnZXRCb29rQnlJZChpZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcHJpc21hLmJvb2suZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHsgXHJcbiAgICAgICAgaWQsXHJcbiAgICAgICAgZGVsZXRlZEF0OiBudWxsXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgbGl2cm8gcG9yIElEIChpbmNsdWluZG8gZGVsZXRhZG9zKVxyXG4gIHN0YXRpYyBhc3luYyBnZXRCb29rQnlJZFdpdGhEZWxldGVkKGlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEuYm9vay5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIEJ1c2NhciBsaXZyb3MgcG9yIGZpbHRyb3MgKGFwZW5hcyBhdGl2b3MpXHJcbiAgc3RhdGljIGFzeW5jIGdldEJvb2tzQnlGaWx0ZXJzKGZpbHRlcnM6IHtcclxuICAgIHNlYXJjaD86IHN0cmluZ1xyXG4gICAgc3RhdHVzPzogc3RyaW5nXHJcbiAgICBnZW5yZT86IHN0cmluZ1xyXG4gIH0pIHtcclxuICAgIGNvbnN0IHsgc2VhcmNoLCBzdGF0dXMsIGdlbnJlIH0gPSBmaWx0ZXJzXHJcbiAgICBcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEuYm9vay5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgQU5EOiBbXHJcbiAgICAgICAgICB7IGRlbGV0ZWRBdDogbnVsbCB9LFxyXG4gICAgICAgICAgc2VhcmNoID8ge1xyXG4gICAgICAgICAgICBPUjogW1xyXG4gICAgICAgICAgICAgIHsgdGl0bGU6IHsgY29udGFpbnM6IHNlYXJjaCB9IH0sXHJcbiAgICAgICAgICAgICAgeyBhdXRob3I6IHsgY29udGFpbnM6IHNlYXJjaCB9IH0sXHJcbiAgICAgICAgICAgICAgeyBjb2RlOiB7IGNvbnRhaW5zOiBzZWFyY2ggfSB9LFxyXG4gICAgICAgICAgICAgIHsgaXNibjogeyBjb250YWluczogc2VhcmNoIH0gfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgICB9IDoge30sXHJcbiAgICAgICAgICBnZW5yZSA/IHsgZ2VucmUgfSA6IHt9LFxyXG4gICAgICAgICAgc3RhdHVzID09PSAnZGlzcG9uw612ZWwnID8geyBjdXJyZW50UXVhbnRpdHk6IHsgZ3Q6IDAgfSB9IDoge30sXHJcbiAgICAgICAgICBzdGF0dXMgPT09ICdlbXByZXN0YWRvJyA/IHsgY3VycmVudFF1YW50aXR5OiB7IGVxdWFsczogMCB9IH0gOiB7fVxyXG4gICAgICAgIF1cclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeTogeyB0aXRsZTogJ2FzYycgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIENyaWFyIG5vdm8gbGl2cm9cclxuICBzdGF0aWMgYXN5bmMgY3JlYXRlQm9vayhkYXRhOiBDcmVhdGVCb29rRGF0YSwgdXNlcklkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjb2RlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUJvb2tDb2RlKGRhdGEuZ2VucmUpXHJcbiAgICAgIGNvbnN0IGJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay5jcmVhdGUoe1xyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIC4uLmRhdGEsXHJcbiAgICAgICAgICBjb2RlLFxyXG4gICAgICAgICAgcXVhbnRpdHk6IGRhdGEucXVhbnRpdHkgfHwgMSxcclxuICAgICAgICAgIGN1cnJlbnRRdWFudGl0eTogZGF0YS5xdWFudGl0eSB8fCAxLFxyXG4gICAgICAgICAgbG9hbnNDb3VudDogMFxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLy8gTG9nIGRlIGF1ZGl0b3JpYVxyXG4gICAgICBhd2FpdCBBdWRpdFNlcnZpY2UubG9nQm9va0NyZWF0aW9uKGJvb2suaWQsIGJvb2ssIHVzZXJJZClcclxuICAgICAgcmV0dXJuIGJvb2tcclxuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgICAgLy8gVmVyaWZpY2FyIHNlIMOpIGVycm8gZGUgY29uc3RyYWludCDDum5pY2FcclxuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdQMjAwMicpIHtcclxuICAgICAgICBpZiAoZXJyb3IubWV0YT8udGFyZ2V0Py5pbmNsdWRlcygnaXNibicpKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lTQk4gasOhIGV4aXN0ZSBubyBzaXN0ZW1hLiBQb3IgZmF2b3IsIHVzZSB1bSBJU0JOIGRpZmVyZW50ZS4nKVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXJyb3IubWV0YT8udGFyZ2V0Py5pbmNsdWRlcygnY29kZScpKSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0PDs2RpZ28gZG8gbGl2cm8gasOhIGV4aXN0ZS4gVGVudGUgbm92YW1lbnRlLicpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRGFkb3MgZHVwbGljYWRvcy4gVmVyaWZpcXVlIHNlIG8gbGl2cm8gasOhIGV4aXN0ZS4nKVxyXG4gICAgICB9XHJcbiAgICAgIHRocm93IGVycm9yXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBBdHVhbGl6YXIgbGl2cm9cclxuICBzdGF0aWMgYXN5bmMgdXBkYXRlQm9vayhpZDogc3RyaW5nLCBkYXRhOiBVcGRhdGVCb29rRGF0YSwgdXNlcklkPzogc3RyaW5nKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBCdXNjYXIgZGFkb3MgYXR1YWlzIGRvIGxpdnJvIHBhcmEgY29tcGFyYcOnw6NvXHJcbiAgICAgIGNvbnN0IGN1cnJlbnRCb29rID0gYXdhaXQgcHJpc21hLmJvb2suZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgXHJcbiAgICAgICAgICBpZCxcclxuICAgICAgICAgIGRlbGV0ZWRBdDogbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIGlmICghY3VycmVudEJvb2spIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xpdnJvIG7Do28gZW5jb250cmFkbycpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJlYWxpemFyIGEgYXR1YWxpemHDp8Ojb1xyXG4gICAgICBjb25zdCB1cGRhdGVkQm9vayA9IGF3YWl0IHByaXNtYS5ib29rLnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgXHJcbiAgICAgICAgICBpZCxcclxuICAgICAgICAgIGRlbGV0ZWRBdDogbnVsbFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZGF0YVxyXG4gICAgICB9KVxyXG5cclxuICAgICAgLy8gTG9nIGRlIGF1ZGl0b3JpYSBwYXJhIGNhbXBvcyBhbHRlcmFkb3MgKGNvbSB0cnkvY2F0Y2ggcGFyYSBuw6NvIGZhbGhhciBhIGF0dWFsaXphw6fDo28pXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgY2hhbmdlZEZpZWxkczogc3RyaW5nW10gPSBbXVxyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgW2ZpZWxkLCBuZXdWYWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YSkpIHtcclxuICAgICAgICAgIC8vIElnbm9yYXIgY2FtcG9zIHF1ZSBuw6NvIGRldmVtIGdlcmFyIGxvZ3NcclxuICAgICAgICAgIGlmIChmaWVsZCA9PT0gJ3VwZGF0ZWRBdCcgfHwgZmllbGQgPT09ICdjcmVhdGVkQXQnIHx8IGZpZWxkID09PSAnZGVsZXRlZEF0Jykge1xyXG4gICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IGN1cnJlbnRCb29rW2ZpZWxkIGFzIGtleW9mIHR5cGVvZiBjdXJyZW50Qm9va11cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gQ29tcGFyYXIgdmFsb3JlcyBjb252ZXJ0ZW5kbyBwYXJhIHN0cmluZyBwYXJhIGV2aXRhciBsb2dzIGRlc25lY2Vzc8Ohcmlvc1xyXG4gICAgICAgICAgaWYgKFN0cmluZyhvbGRWYWx1ZSkgIT09IFN0cmluZyhuZXdWYWx1ZSkpIHtcclxuICAgICAgICAgICAgY2hhbmdlZEZpZWxkcy5wdXNoKGZpZWxkKVxyXG4gICAgICAgICAgICBhd2FpdCBBdWRpdFNlcnZpY2UubG9nQm9va1VwZGF0ZShcclxuICAgICAgICAgICAgICBpZCwgXHJcbiAgICAgICAgICAgICAgZmllbGQsIFxyXG4gICAgICAgICAgICAgIG9sZFZhbHVlLCBcclxuICAgICAgICAgICAgICBuZXdWYWx1ZSwgXHJcbiAgICAgICAgICAgICAgdXNlcklkXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2UgbmVuaHVtIGNhbXBvIGZvaSBhbHRlcmFkbywgbsOjbyBjcmlhciBsb2dcclxuICAgICAgICBpZiAoY2hhbmdlZEZpZWxkcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdOZW5odW0gY2FtcG8gZm9pIGFsdGVyYWRvIG5vIGxpdnJvOicsIGlkKVxyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoYXVkaXRFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gYW8gY3JpYXIgbG9nIGRlIGF1ZGl0b3JpYTonLCBhdWRpdEVycm9yKVxyXG4gICAgICAgIC8vIE7Do28gZmFsaGFyIGEgYXR1YWxpemHDp8OjbyBwb3IgY2F1c2EgZG8gbG9nXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB1cGRhdGVkQm9va1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJybyBubyB1cGRhdGVCb29rOicsIGVycm9yKVxyXG4gICAgICB0aHJvdyBlcnJvclxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gU29mdCBkZWxldGUgLSBtYXJjYXIgY29tbyBkZWxldGFkb1xyXG4gIHN0YXRpYyBhc3luYyBzb2Z0RGVsZXRlQm9vayhpZDogc3RyaW5nLCB1c2VySWQ/OiBzdHJpbmcpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEJ1c2NhciBkYWRvcyBkbyBsaXZybyBhbnRlcyBkYSBkZWxlw6fDo28gcGFyYSBvIGxvZ1xyXG4gICAgICBjb25zdCBib29rRGF0YSA9IGF3YWl0IHByaXNtYS5ib29rLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIGlmICghYm9va0RhdGEpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xpdnJvIG7Do28gZW5jb250cmFkbycpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIFJlYWxpemFyIG8gc29mdCBkZWxldGVcclxuICAgICAgY29uc3QgZGVsZXRlZEJvb2sgPSBhd2FpdCBwcmlzbWEuYm9vay51cGRhdGUoe1xyXG4gICAgICAgIHdoZXJlOiB7IFxyXG4gICAgICAgICAgaWQsXHJcbiAgICAgICAgICBkZWxldGVkQXQ6IG51bGxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIGRlbGV0ZWRBdDogbmV3IERhdGUoKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuXHJcbiAgICAgIC8vIExvZyBkZSBhdWRpdG9yaWEgKGNvbSB0cnkvY2F0Y2ggcGFyYSBuw6NvIGZhbGhhciBhIGRlbGXDp8OjbylcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhd2FpdCBBdWRpdFNlcnZpY2UubG9nQm9va0RlbGV0aW9uKGlkLCBib29rRGF0YSwgdXNlcklkKVxyXG4gICAgICB9IGNhdGNoIChhdWRpdEVycm9yKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJybyBhbyBjcmlhciBsb2cgZGUgYXVkaXRvcmlhOicsIGF1ZGl0RXJyb3IpXHJcbiAgICAgICAgLy8gTsOjbyBmYWxoYXIgYSBkZWxlw6fDo28gcG9yIGNhdXNhIGRvIGxvZ1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gZGVsZXRlZEJvb2tcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm8gbm8gc29mdERlbGV0ZUJvb2s6JywgZXJyb3IpXHJcbiAgICAgIHRocm93IGVycm9yXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBSZXN0YXVyYXIgbGl2cm8gZGVsZXRhZG9cclxuICBzdGF0aWMgYXN5bmMgcmVzdG9yZUJvb2soaWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGF3YWl0IHByaXNtYS5ib29rLnVwZGF0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IFxyXG4gICAgICAgIGlkLFxyXG4gICAgICAgIGRlbGV0ZWRBdDoge1xyXG4gICAgICAgICAgbm90OiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgZGVsZXRlZEF0OiBudWxsXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBIYXJkIGRlbGV0ZSAtIGV4Y2x1aXIgcGVybWFuZW50ZW1lbnRlXHJcbiAgc3RhdGljIGFzeW5jIGhhcmREZWxldGVCb29rKGlkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEuYm9vay5kZWxldGUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gQnVzY2FyIGVzdGF0w61zdGljYXMgZGUgbGl2cm9zIChhcGVuYXMgYXRpdm9zKVxyXG4gIHN0YXRpYyBhc3luYyBnZXRCb29rU3RhdHMoKSB7XHJcbiAgICBjb25zdCB0b3RhbEJvb2tzID0gYXdhaXQgcHJpc21hLmJvb2suY291bnQoe1xyXG4gICAgICB3aGVyZTogeyBkZWxldGVkQXQ6IG51bGwgfVxyXG4gICAgfSlcclxuICAgIGNvbnNvbGUubG9nKHRvdGFsQm9va3MpXHJcbiAgICAvLyBDYWxjdWxhciBsaXZyb3MgZGlzcG9uw612ZWlzIChzb21hIGRlIHRvZG9zIG9zIGV4ZW1wbGFyZXMgZGlzcG9uw612ZWlzKVxyXG4gICAgY29uc3QgYm9va3NXaXRoQXZhaWxhYmlsaXR5ID0gYXdhaXQgcHJpc21hLmJvb2suZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBkZWxldGVkQXQ6IG51bGwgfSxcclxuICAgICAgc2VsZWN0OiB7IGN1cnJlbnRRdWFudGl0eTogdHJ1ZSB9XHJcbiAgICB9KVxyXG4gICAgY29uc3QgYXZhaWxhYmxlQm9va3MgPSBib29rc1dpdGhBdmFpbGFiaWxpdHkucmVkdWNlKChzdW0sIGJvb2spID0+IHN1bSArIGJvb2suY3VycmVudFF1YW50aXR5LCAwKVxyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhciBsaXZyb3MgZW1wcmVzdGFkb3MgKGVtcHLDqXN0aW1vcyBhdGl2b3MpXHJcbiAgICBjb25zdCBhY3RpdmVMb2FucyA9IGF3YWl0IHByaXNtYS5sb2FuLmNvdW50KHtcclxuICAgICAgd2hlcmU6IHsgc3RhdHVzOiAnQUNUSVZFJyB9XHJcbiAgICB9KVxyXG5cclxuICAgIGNvbnN0IGdlbnJlcyA9IGF3YWl0IHByaXNtYS5ib29rLmdyb3VwQnkoe1xyXG4gICAgICBieTogWydnZW5yZSddLFxyXG4gICAgICB3aGVyZTogeyBkZWxldGVkQXQ6IG51bGwgfSxcclxuICAgICAgX2NvdW50OiB7IGdlbnJlOiB0cnVlIH1cclxuICAgIH0pXHJcblxyXG4gICAgY29uc3QgYm9va3NCeVllYXIgPSBhd2FpdCBwcmlzbWEuYm9vay5ncm91cEJ5KHtcclxuICAgICAgYnk6IFsneWVhciddLFxyXG4gICAgICB3aGVyZTogeyBcclxuICAgICAgICB5ZWFyOiB7IG5vdDogbnVsbCB9LFxyXG4gICAgICAgIGRlbGV0ZWRBdDogbnVsbFxyXG4gICAgICB9LFxyXG4gICAgICBfY291bnQ6IHsgeWVhcjogdHJ1ZSB9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvdGFsQm9va3MsXHJcbiAgICAgIGF2YWlsYWJsZUJvb2tzLFxyXG4gICAgICBib3Jyb3dlZEJvb2tzOiBhY3RpdmVMb2FucyxcclxuICAgICAgZ2VucmVzOiBnZW5yZXMubWFwKGdlbnJlID0+ICh7XHJcbiAgICAgICAgZ2VucmU6IGdlbnJlLmdlbnJlLFxyXG4gICAgICAgIGNvdW50OiBnZW5yZS5fY291bnQuZ2VucmVcclxuICAgICAgfSkpLFxyXG4gICAgICBib29rc0J5WWVhcjogYm9va3NCeVllYXIubWFwKHllYXIgPT4gKHtcclxuICAgICAgICB5ZWFyOiB5ZWFyLnllYXIsXHJcbiAgICAgICAgY291bnQ6IHllYXIuX2NvdW50LnllYXJcclxuICAgICAgfSkpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgbGl2cm9zIG1haXMgZW1wcmVzdGFkb3MgKGFwZW5hcyBhdGl2b3MpXHJcbiAgc3RhdGljIGFzeW5jIGdldFRvcEJvb2tzKGxpbWl0OiBudW1iZXIgPSA1KSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcHJpc21hLmJvb2suZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyBkZWxldGVkQXQ6IG51bGwgfSxcclxuICAgICAgdGFrZTogbGltaXQsXHJcbiAgICAgIG9yZGVyQnk6IHtcclxuICAgICAgICBsb2Fuc0NvdW50OiAnZGVzYydcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIEluY3JlbWVudGFyIGNvbnRhZG9yIGRlIGVtcHLDqXN0aW1vc1xyXG4gIHN0YXRpYyBhc3luYyBpbmNyZW1lbnRMb2Fuc0NvdW50KGJvb2tJZDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcHJpc21hLmJvb2sudXBkYXRlKHtcclxuICAgICAgd2hlcmU6IHsgXHJcbiAgICAgICAgaWQ6IGJvb2tJZCxcclxuICAgICAgICBkZWxldGVkQXQ6IG51bGxcclxuICAgICAgfSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGxvYW5zQ291bnQ6IHtcclxuICAgICAgICAgIGluY3JlbWVudDogMVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY3VycmVudFF1YW50aXR5OiB7XHJcbiAgICAgICAgICBkZWNyZW1lbnQ6IDFcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBEZWNyZW1lbnRhciBjb250YWRvciBkZSBlbXByw6lzdGltb3MgKHF1YW5kbyBsaXZybyDDqSBkZXZvbHZpZG8pXHJcbiAgc3RhdGljIGFzeW5jIGRlY3JlbWVudExvYW5zQ291bnQoYm9va0lkOiBzdHJpbmcpIHtcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEuYm9vay51cGRhdGUoe1xyXG4gICAgICB3aGVyZTogeyBcclxuICAgICAgICBpZDogYm9va0lkLFxyXG4gICAgICAgIGRlbGV0ZWRBdDogbnVsbFxyXG4gICAgICB9LFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgY3VycmVudFF1YW50aXR5OiB7XHJcbiAgICAgICAgICBpbmNyZW1lbnQ6IDFcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuXHJcbn0gIl0sIm5hbWVzIjpbInByaXNtYSIsIkF1ZGl0U2VydmljZSIsIkJvb2tTZXJ2aWNlIiwiZ2VuZXJhdGVCb29rQ29kZSIsImdlbnJlIiwiY3VycmVudFllYXIiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJ0b1N0cmluZyIsInNsaWNlIiwibGFzdEJvb2siLCJib29rIiwiZmluZEZpcnN0Iiwid2hlcmUiLCJjb2RlIiwiY29udGFpbnMiLCJkZWxldGVkQXQiLCJvcmRlckJ5IiwibmV4dE51bWJlciIsImxhc3ROdW1iZXIiLCJwYXJzZUludCIsInNwbGl0IiwiZ2VucmVBYmJyZXZpYXRpb24iLCJzdWJzdHJpbmciLCJ0b1VwcGVyQ2FzZSIsInBhZFN0YXJ0IiwiZ2V0QWxsQm9va3MiLCJmaW5kTWFueSIsInRpdGxlIiwiZ2V0QWxsQm9va3NXaXRoRGVsZXRlZCIsImdldERlbGV0ZWRCb29rcyIsIm5vdCIsImdldEJvb2tCeUlkIiwiaWQiLCJnZXRCb29rQnlJZFdpdGhEZWxldGVkIiwiZmluZFVuaXF1ZSIsImdldEJvb2tzQnlGaWx0ZXJzIiwiZmlsdGVycyIsInNlYXJjaCIsInN0YXR1cyIsIkFORCIsIk9SIiwiYXV0aG9yIiwiaXNibiIsImN1cnJlbnRRdWFudGl0eSIsImd0IiwiZXF1YWxzIiwiY3JlYXRlQm9vayIsImRhdGEiLCJ1c2VySWQiLCJjcmVhdGUiLCJxdWFudGl0eSIsImxvYW5zQ291bnQiLCJsb2dCb29rQ3JlYXRpb24iLCJlcnJvciIsIm1ldGEiLCJ0YXJnZXQiLCJpbmNsdWRlcyIsIkVycm9yIiwidXBkYXRlQm9vayIsImN1cnJlbnRCb29rIiwidXBkYXRlZEJvb2siLCJ1cGRhdGUiLCJjaGFuZ2VkRmllbGRzIiwiZmllbGQiLCJuZXdWYWx1ZSIsIk9iamVjdCIsImVudHJpZXMiLCJvbGRWYWx1ZSIsIlN0cmluZyIsInB1c2giLCJsb2dCb29rVXBkYXRlIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsImF1ZGl0RXJyb3IiLCJzb2Z0RGVsZXRlQm9vayIsImJvb2tEYXRhIiwiZGVsZXRlZEJvb2siLCJsb2dCb29rRGVsZXRpb24iLCJyZXN0b3JlQm9vayIsImhhcmREZWxldGVCb29rIiwiZGVsZXRlIiwiZ2V0Qm9va1N0YXRzIiwidG90YWxCb29rcyIsImNvdW50IiwiYm9va3NXaXRoQXZhaWxhYmlsaXR5Iiwic2VsZWN0IiwiYXZhaWxhYmxlQm9va3MiLCJyZWR1Y2UiLCJzdW0iLCJhY3RpdmVMb2FucyIsImxvYW4iLCJnZW5yZXMiLCJncm91cEJ5IiwiYnkiLCJfY291bnQiLCJib29rc0J5WWVhciIsInllYXIiLCJib3Jyb3dlZEJvb2tzIiwibWFwIiwiZ2V0VG9wQm9va3MiLCJsaW1pdCIsInRha2UiLCJpbmNyZW1lbnRMb2Fuc0NvdW50IiwiYm9va0lkIiwiaW5jcmVtZW50IiwiZGVjcmVtZW50IiwiZGVjcmVtZW50TG9hbnNDb3VudCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/books.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/loans.ts":
/*!***********************************!*\
  !*** ./src/lib/services/loans.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   LoanService: () => (/* binding */ LoanService)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _books__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./books */ \"(rsc)/./src/lib/services/books.ts\");\n\n\nclass LoanService {\n    // Buscar todos os empréstimos\n    static async getAllLoans() {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findMany({\n            include: {\n                book: true,\n                student: true\n            },\n            orderBy: {\n                borrowedAt: \"desc\"\n            }\n        });\n    }\n    // Buscar empréstimo por ID\n    static async getLoanById(id) {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findUnique({\n            where: {\n                id\n            },\n            include: {\n                book: true,\n                student: true\n            }\n        });\n    }\n    // Buscar empréstimos por filtros\n    static async getLoansByFilters(filters) {\n        const { search, status, period } = filters;\n        let dateFilter = {};\n        if (period === \"mes\") {\n            const oneMonthAgo = new Date();\n            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);\n            dateFilter = {\n                borrowedAt: {\n                    gte: oneMonthAgo\n                }\n            };\n        } else if (period === \"trimestre\") {\n            const threeMonthsAgo = new Date();\n            threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);\n            dateFilter = {\n                borrowedAt: {\n                    gte: threeMonthsAgo\n                }\n            };\n        } else if (period === \"ano\") {\n            const oneYearAgo = new Date();\n            oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);\n            dateFilter = {\n                borrowedAt: {\n                    gte: oneYearAgo\n                }\n            };\n        }\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findMany({\n            where: {\n                AND: [\n                    search ? {\n                        OR: [\n                            {\n                                book: {\n                                    title: {\n                                        contains: search\n                                    }\n                                }\n                            },\n                            {\n                                book: {\n                                    code: {\n                                        contains: search\n                                    }\n                                }\n                            },\n                            {\n                                student: {\n                                    name: {\n                                        contains: search\n                                    }\n                                }\n                            }\n                        ]\n                    } : {},\n                    status ? {\n                        status\n                    } : {},\n                    dateFilter\n                ]\n            },\n            include: {\n                book: true,\n                student: true\n            },\n            orderBy: {\n                borrowedAt: \"desc\"\n            }\n        });\n    }\n    // Criar novo empréstimo\n    static async createLoan(data) {\n        // Verificar se o livro existe e tem exemplares disponíveis\n        const book = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findUnique({\n            where: {\n                id: data.bookId\n            }\n        });\n        if (!book) {\n            throw new Error(\"Livro n\\xe3o encontrado\");\n        }\n        if (book.currentQuantity <= 0) {\n            throw new Error(\"N\\xe3o h\\xe1 exemplares dispon\\xedveis deste livro\");\n        }\n        // Verificar se o aluno já tem um empréstimo ativo deste livro\n        const existingLoan = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findFirst({\n            where: {\n                bookId: data.bookId,\n                studentId: data.studentId,\n                status: \"ACTIVE\"\n            }\n        });\n        if (existingLoan) {\n            throw new Error(\"O aluno j\\xe1 possui um empr\\xe9stimo ativo deste livro\");\n        }\n        // Criar o empréstimo\n        const loan = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.create({\n            data,\n            include: {\n                book: true,\n                student: true\n            }\n        });\n        // Atualizar quantidade disponível e contador de empréstimos do livro\n        await _books__WEBPACK_IMPORTED_MODULE_1__.BookService.incrementLoansCount(data.bookId);\n        return loan;\n    }\n    // Devolver empréstimo\n    static async returnLoan(id) {\n        const loan = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.update({\n            where: {\n                id\n            },\n            data: {\n                status: \"RETURNED\",\n                returnedAt: new Date()\n            },\n            include: {\n                book: true,\n                student: true\n            }\n        });\n        // Atualizar quantidade disponível do livro\n        await _books__WEBPACK_IMPORTED_MODULE_1__.BookService.decrementLoansCount(loan.bookId);\n        return loan;\n    }\n    // Deletar empréstimo\n    static async deleteLoan(id) {\n        const loan = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findUnique({\n            where: {\n                id\n            },\n            select: {\n                bookId: true,\n                status: true\n            }\n        });\n        if (loan && loan.status === \"ACTIVE\") {\n            // Se o empréstimo está ativo, devolver o livro ao acervo\n            await _books__WEBPACK_IMPORTED_MODULE_1__.BookService.decrementLoansCount(loan.bookId);\n        }\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.delete({\n            where: {\n                id\n            }\n        });\n    }\n    // Buscar estatísticas de empréstimos\n    static async getLoanStats() {\n        const totalLoans = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.count();\n        const activeLoans = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.count({\n            where: {\n                status: \"ACTIVE\"\n            }\n        });\n        const returnedLoans = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.count({\n            where: {\n                status: \"RETURNED\"\n            }\n        });\n        const overdueLoans = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.count({\n            where: {\n                status: \"ACTIVE\",\n                dueDate: {\n                    lt: new Date()\n                }\n            }\n        });\n        return {\n            totalLoans,\n            activeLoans,\n            returnedLoans,\n            overdueLoans\n        };\n    }\n    // Buscar empréstimos em atraso\n    static async getOverdueLoans() {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findMany({\n            where: {\n                status: \"ACTIVE\",\n                dueDate: {\n                    lt: new Date()\n                }\n            },\n            include: {\n                book: true,\n                student: true\n            },\n            orderBy: {\n                dueDate: \"asc\"\n            }\n        });\n    }\n    // Buscar empréstimos por período\n    static async getLoansByPeriod(period) {\n        let startDate = new Date();\n        switch(period){\n            case \"mes\":\n                startDate.setMonth(startDate.getMonth() - 1);\n                break;\n            case \"trimestre\":\n                startDate.setMonth(startDate.getMonth() - 3);\n                break;\n            case \"ano\":\n                startDate.setFullYear(startDate.getFullYear() - 1);\n                break;\n            default:\n                startDate = new Date(0) // Desde o início\n                ;\n        }\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findMany({\n            where: {\n                borrowedAt: {\n                    gte: startDate\n                }\n            },\n            include: {\n                book: true,\n                student: true\n            },\n            orderBy: {\n                borrowedAt: \"desc\"\n            }\n        });\n    }\n    // Buscar livros disponíveis para empréstimo\n    static async getAvailableBooks() {\n        return await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.book.findMany({\n            where: {\n                currentQuantity: {\n                    gt: 0\n                },\n                deletedAt: null\n            },\n            orderBy: {\n                title: \"asc\"\n            }\n        });\n    }\n    // Verificar se aluno pode emprestar um livro específico\n    static async canStudentBorrowBook(studentId, bookId) {\n        const existingLoan = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.loan.findFirst({\n            where: {\n                bookId,\n                studentId,\n                status: \"ACTIVE\"\n            }\n        });\n        return !existingLoan;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL2xvYW5zLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFrQztBQUVHO0FBVzlCLE1BQU1FO0lBQ1gsOEJBQThCO0lBQzlCLGFBQWFDLGNBQWM7UUFDekIsT0FBTyxNQUFNSCwyQ0FBTUEsQ0FBQ0ksSUFBSSxDQUFDQyxRQUFRLENBQUM7WUFDaENDLFNBQVM7Z0JBQ1BDLE1BQU07Z0JBQ05DLFNBQVM7WUFDWDtZQUNBQyxTQUFTO2dCQUFFQyxZQUFZO1lBQU87UUFDaEM7SUFDRjtJQUVBLDJCQUEyQjtJQUMzQixhQUFhQyxZQUFZQyxFQUFVLEVBQUU7UUFDbkMsT0FBTyxNQUFNWiwyQ0FBTUEsQ0FBQ0ksSUFBSSxDQUFDUyxVQUFVLENBQUM7WUFDbENDLE9BQU87Z0JBQUVGO1lBQUc7WUFDWk4sU0FBUztnQkFDUEMsTUFBTTtnQkFDTkMsU0FBUztZQUNYO1FBQ0Y7SUFDRjtJQUVBLGlDQUFpQztJQUNqQyxhQUFhTyxrQkFBa0JDLE9BSTlCLEVBQUU7UUFDRCxNQUFNLEVBQUVDLE1BQU0sRUFBRUMsTUFBTSxFQUFFQyxNQUFNLEVBQUUsR0FBR0g7UUFFbkMsSUFBSUksYUFBYSxDQUFDO1FBQ2xCLElBQUlELFdBQVcsT0FBTztZQUNwQixNQUFNRSxjQUFjLElBQUlDO1lBQ3hCRCxZQUFZRSxRQUFRLENBQUNGLFlBQVlHLFFBQVEsS0FBSztZQUM5Q0osYUFBYTtnQkFBRVYsWUFBWTtvQkFBRWUsS0FBS0o7Z0JBQVk7WUFBRTtRQUNsRCxPQUFPLElBQUlGLFdBQVcsYUFBYTtZQUNqQyxNQUFNTyxpQkFBaUIsSUFBSUo7WUFDM0JJLGVBQWVILFFBQVEsQ0FBQ0csZUFBZUYsUUFBUSxLQUFLO1lBQ3BESixhQUFhO2dCQUFFVixZQUFZO29CQUFFZSxLQUFLQztnQkFBZTtZQUFFO1FBQ3JELE9BQU8sSUFBSVAsV0FBVyxPQUFPO1lBQzNCLE1BQU1RLGFBQWEsSUFBSUw7WUFDdkJLLFdBQVdDLFdBQVcsQ0FBQ0QsV0FBV0UsV0FBVyxLQUFLO1lBQ2xEVCxhQUFhO2dCQUFFVixZQUFZO29CQUFFZSxLQUFLRTtnQkFBVztZQUFFO1FBQ2pEO1FBRUEsT0FBTyxNQUFNM0IsMkNBQU1BLENBQUNJLElBQUksQ0FBQ0MsUUFBUSxDQUFDO1lBQ2hDUyxPQUFPO2dCQUNMZ0IsS0FBSztvQkFDSGIsU0FBUzt3QkFDUGMsSUFBSTs0QkFDRjtnQ0FBRXhCLE1BQU07b0NBQUV5QixPQUFPO3dDQUFFQyxVQUFVaEI7b0NBQU87Z0NBQUU7NEJBQUU7NEJBQ3hDO2dDQUFFVixNQUFNO29DQUFFMkIsTUFBTTt3Q0FBRUQsVUFBVWhCO29DQUFPO2dDQUFFOzRCQUFFOzRCQUN2QztnQ0FBRVQsU0FBUztvQ0FBRTJCLE1BQU07d0NBQUVGLFVBQVVoQjtvQ0FBTztnQ0FBRTs0QkFBRTt5QkFDM0M7b0JBQ0gsSUFBSSxDQUFDO29CQUNMQyxTQUFTO3dCQUFFQTtvQkFBTyxJQUFJLENBQUM7b0JBQ3ZCRTtpQkFDRDtZQUNIO1lBQ0FkLFNBQVM7Z0JBQ1BDLE1BQU07Z0JBQ05DLFNBQVM7WUFDWDtZQUNBQyxTQUFTO2dCQUFFQyxZQUFZO1lBQU87UUFDaEM7SUFDRjtJQUVBLHdCQUF3QjtJQUN4QixhQUFhMEIsV0FBV0MsSUFBb0IsRUFBRTtRQUM1QywyREFBMkQ7UUFDM0QsTUFBTTlCLE9BQU8sTUFBTVAsMkNBQU1BLENBQUNPLElBQUksQ0FBQ00sVUFBVSxDQUFDO1lBQ3hDQyxPQUFPO2dCQUFFRixJQUFJeUIsS0FBS0MsTUFBTTtZQUFDO1FBQzNCO1FBRUEsSUFBSSxDQUFDL0IsTUFBTTtZQUNULE1BQU0sSUFBSWdDLE1BQU07UUFDbEI7UUFFQSxJQUFJaEMsS0FBS2lDLGVBQWUsSUFBSSxHQUFHO1lBQzdCLE1BQU0sSUFBSUQsTUFBTTtRQUNsQjtRQUVBLDhEQUE4RDtRQUM5RCxNQUFNRSxlQUFlLE1BQU16QywyQ0FBTUEsQ0FBQ0ksSUFBSSxDQUFDc0MsU0FBUyxDQUFDO1lBQy9DNUIsT0FBTztnQkFDTHdCLFFBQVFELEtBQUtDLE1BQU07Z0JBQ25CSyxXQUFXTixLQUFLTSxTQUFTO2dCQUN6QnpCLFFBQVE7WUFDVjtRQUNGO1FBRUEsSUFBSXVCLGNBQWM7WUFDaEIsTUFBTSxJQUFJRixNQUFNO1FBQ2xCO1FBRUEscUJBQXFCO1FBQ3JCLE1BQU1uQyxPQUFPLE1BQU1KLDJDQUFNQSxDQUFDSSxJQUFJLENBQUN3QyxNQUFNLENBQUM7WUFDcENQO1lBQ0EvQixTQUFTO2dCQUNQQyxNQUFNO2dCQUNOQyxTQUFTO1lBQ1g7UUFDRjtRQUVBLHFFQUFxRTtRQUNyRSxNQUFNUCwrQ0FBV0EsQ0FBQzRDLG1CQUFtQixDQUFDUixLQUFLQyxNQUFNO1FBRWpELE9BQU9sQztJQUNUO0lBSUEsc0JBQXNCO0lBQ3RCLGFBQWEwQyxXQUFXbEMsRUFBVSxFQUFFO1FBQ2xDLE1BQU1SLE9BQU8sTUFBTUosMkNBQU1BLENBQUNJLElBQUksQ0FBQzJDLE1BQU0sQ0FBQztZQUNwQ2pDLE9BQU87Z0JBQUVGO1lBQUc7WUFDWnlCLE1BQU07Z0JBQ0puQixRQUFRO2dCQUNSOEIsWUFBWSxJQUFJMUI7WUFDbEI7WUFDQWhCLFNBQVM7Z0JBQ1BDLE1BQU07Z0JBQ05DLFNBQVM7WUFDWDtRQUNGO1FBRUEsMkNBQTJDO1FBQzNDLE1BQU1QLCtDQUFXQSxDQUFDZ0QsbUJBQW1CLENBQUM3QyxLQUFLa0MsTUFBTTtRQUVqRCxPQUFPbEM7SUFDVDtJQUVBLHFCQUFxQjtJQUNyQixhQUFhOEMsV0FBV3RDLEVBQVUsRUFBRTtRQUNsQyxNQUFNUixPQUFPLE1BQU1KLDJDQUFNQSxDQUFDSSxJQUFJLENBQUNTLFVBQVUsQ0FBQztZQUN4Q0MsT0FBTztnQkFBRUY7WUFBRztZQUNadUMsUUFBUTtnQkFBRWIsUUFBUTtnQkFBTXBCLFFBQVE7WUFBSztRQUN2QztRQUVBLElBQUlkLFFBQVFBLEtBQUtjLE1BQU0sS0FBSyxVQUFVO1lBQ3BDLHlEQUF5RDtZQUN6RCxNQUFNakIsK0NBQVdBLENBQUNnRCxtQkFBbUIsQ0FBQzdDLEtBQUtrQyxNQUFNO1FBQ25EO1FBRUEsT0FBTyxNQUFNdEMsMkNBQU1BLENBQUNJLElBQUksQ0FBQ2dELE1BQU0sQ0FBQztZQUM5QnRDLE9BQU87Z0JBQUVGO1lBQUc7UUFDZDtJQUNGO0lBRUEscUNBQXFDO0lBQ3JDLGFBQWF5QyxlQUFlO1FBQzFCLE1BQU1DLGFBQWEsTUFBTXRELDJDQUFNQSxDQUFDSSxJQUFJLENBQUNtRCxLQUFLO1FBQzFDLE1BQU1DLGNBQWMsTUFBTXhELDJDQUFNQSxDQUFDSSxJQUFJLENBQUNtRCxLQUFLLENBQUM7WUFDMUN6QyxPQUFPO2dCQUFFSSxRQUFRO1lBQVM7UUFDNUI7UUFDQSxNQUFNdUMsZ0JBQWdCLE1BQU16RCwyQ0FBTUEsQ0FBQ0ksSUFBSSxDQUFDbUQsS0FBSyxDQUFDO1lBQzVDekMsT0FBTztnQkFBRUksUUFBUTtZQUFXO1FBQzlCO1FBQ0EsTUFBTXdDLGVBQWUsTUFBTTFELDJDQUFNQSxDQUFDSSxJQUFJLENBQUNtRCxLQUFLLENBQUM7WUFDM0N6QyxPQUFPO2dCQUNMSSxRQUFRO2dCQUNSeUMsU0FBUztvQkFBRUMsSUFBSSxJQUFJdEM7Z0JBQU87WUFDNUI7UUFDRjtRQUVBLE9BQU87WUFDTGdDO1lBQ0FFO1lBQ0FDO1lBQ0FDO1FBQ0Y7SUFDRjtJQUVBLCtCQUErQjtJQUMvQixhQUFhRyxrQkFBa0I7UUFDN0IsT0FBTyxNQUFNN0QsMkNBQU1BLENBQUNJLElBQUksQ0FBQ0MsUUFBUSxDQUFDO1lBQ2hDUyxPQUFPO2dCQUNMSSxRQUFRO2dCQUNSeUMsU0FBUztvQkFBRUMsSUFBSSxJQUFJdEM7Z0JBQU87WUFDNUI7WUFDQWhCLFNBQVM7Z0JBQ1BDLE1BQU07Z0JBQ05DLFNBQVM7WUFDWDtZQUNBQyxTQUFTO2dCQUFFa0QsU0FBUztZQUFNO1FBQzVCO0lBQ0Y7SUFFQSxpQ0FBaUM7SUFDakMsYUFBYUcsaUJBQWlCM0MsTUFBYyxFQUFFO1FBQzVDLElBQUk0QyxZQUFZLElBQUl6QztRQUVwQixPQUFRSDtZQUNOLEtBQUs7Z0JBQ0g0QyxVQUFVeEMsUUFBUSxDQUFDd0MsVUFBVXZDLFFBQVEsS0FBSztnQkFDMUM7WUFDRixLQUFLO2dCQUNIdUMsVUFBVXhDLFFBQVEsQ0FBQ3dDLFVBQVV2QyxRQUFRLEtBQUs7Z0JBQzFDO1lBQ0YsS0FBSztnQkFDSHVDLFVBQVVuQyxXQUFXLENBQUNtQyxVQUFVbEMsV0FBVyxLQUFLO2dCQUNoRDtZQUNGO2dCQUNFa0MsWUFBWSxJQUFJekMsS0FBSyxHQUFHLGlCQUFpQjs7UUFDN0M7UUFFQSxPQUFPLE1BQU10QiwyQ0FBTUEsQ0FBQ0ksSUFBSSxDQUFDQyxRQUFRLENBQUM7WUFDaENTLE9BQU87Z0JBQ0xKLFlBQVk7b0JBQUVlLEtBQUtzQztnQkFBVTtZQUMvQjtZQUNBekQsU0FBUztnQkFDUEMsTUFBTTtnQkFDTkMsU0FBUztZQUNYO1lBQ0FDLFNBQVM7Z0JBQUVDLFlBQVk7WUFBTztRQUNoQztJQUNGO0lBRUEsNENBQTRDO0lBQzVDLGFBQWFzRCxvQkFBb0I7UUFDL0IsT0FBTyxNQUFNaEUsMkNBQU1BLENBQUNPLElBQUksQ0FBQ0YsUUFBUSxDQUFDO1lBQ2hDUyxPQUFPO2dCQUNMMEIsaUJBQWlCO29CQUFFeUIsSUFBSTtnQkFBRTtnQkFDekJDLFdBQVc7WUFDYjtZQUNBekQsU0FBUztnQkFBRXVCLE9BQU87WUFBTTtRQUMxQjtJQUNGO0lBRUEsd0RBQXdEO0lBQ3hELGFBQWFtQyxxQkFBcUJ4QixTQUFpQixFQUFFTCxNQUFjLEVBQUU7UUFDbkUsTUFBTUcsZUFBZSxNQUFNekMsMkNBQU1BLENBQUNJLElBQUksQ0FBQ3NDLFNBQVMsQ0FBQztZQUMvQzVCLE9BQU87Z0JBQ0x3QjtnQkFDQUs7Z0JBQ0F6QixRQUFRO1lBQ1Y7UUFDRjtRQUVBLE9BQU8sQ0FBQ3VCO0lBQ1Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2JpYmxpb3RlY2EtZXNjb2xhci8uL3NyYy9saWIvc2VydmljZXMvbG9hbnMudHM/NjEwNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi9wcmlzbWEnXHJcbmltcG9ydCB7IExvYW4sIExvYW5TdGF0dXMgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcclxuaW1wb3J0IHsgQm9va1NlcnZpY2UgfSBmcm9tICcuL2Jvb2tzJ1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVMb2FuRGF0YSB7XHJcbiAgYm9va0lkOiBzdHJpbmdcclxuICBzdHVkZW50SWQ6IHN0cmluZ1xyXG4gIGR1ZURhdGU6IERhdGVcclxuICBub3Rlcz86IHN0cmluZ1xyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBMb2FuU2VydmljZSB7XHJcbiAgLy8gQnVzY2FyIHRvZG9zIG9zIGVtcHLDqXN0aW1vc1xyXG4gIHN0YXRpYyBhc3luYyBnZXRBbGxMb2FucygpIHtcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEubG9hbi5maW5kTWFueSh7XHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBib29rOiB0cnVlLFxyXG4gICAgICAgIHN0dWRlbnQ6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeTogeyBib3Jyb3dlZEF0OiAnZGVzYycgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIEJ1c2NhciBlbXByw6lzdGltbyBwb3IgSURcclxuICBzdGF0aWMgYXN5bmMgZ2V0TG9hbkJ5SWQoaWQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIGF3YWl0IHByaXNtYS5sb2FuLmZpbmRVbmlxdWUoe1xyXG4gICAgICB3aGVyZTogeyBpZCB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgYm9vazogdHJ1ZSxcclxuICAgICAgICBzdHVkZW50OiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgZW1wcsOpc3RpbW9zIHBvciBmaWx0cm9zXHJcbiAgc3RhdGljIGFzeW5jIGdldExvYW5zQnlGaWx0ZXJzKGZpbHRlcnM6IHtcclxuICAgIHNlYXJjaD86IHN0cmluZ1xyXG4gICAgc3RhdHVzPzogTG9hblN0YXR1c1xyXG4gICAgcGVyaW9kPzogc3RyaW5nXHJcbiAgfSkge1xyXG4gICAgY29uc3QgeyBzZWFyY2gsIHN0YXR1cywgcGVyaW9kIH0gPSBmaWx0ZXJzXHJcbiAgICBcclxuICAgIGxldCBkYXRlRmlsdGVyID0ge31cclxuICAgIGlmIChwZXJpb2QgPT09ICdtZXMnKSB7XHJcbiAgICAgIGNvbnN0IG9uZU1vbnRoQWdvID0gbmV3IERhdGUoKVxyXG4gICAgICBvbmVNb250aEFnby5zZXRNb250aChvbmVNb250aEFnby5nZXRNb250aCgpIC0gMSlcclxuICAgICAgZGF0ZUZpbHRlciA9IHsgYm9ycm93ZWRBdDogeyBndGU6IG9uZU1vbnRoQWdvIH0gfVxyXG4gICAgfSBlbHNlIGlmIChwZXJpb2QgPT09ICd0cmltZXN0cmUnKSB7XHJcbiAgICAgIGNvbnN0IHRocmVlTW9udGhzQWdvID0gbmV3IERhdGUoKVxyXG4gICAgICB0aHJlZU1vbnRoc0Fnby5zZXRNb250aCh0aHJlZU1vbnRoc0Fnby5nZXRNb250aCgpIC0gMylcclxuICAgICAgZGF0ZUZpbHRlciA9IHsgYm9ycm93ZWRBdDogeyBndGU6IHRocmVlTW9udGhzQWdvIH0gfVxyXG4gICAgfSBlbHNlIGlmIChwZXJpb2QgPT09ICdhbm8nKSB7XHJcbiAgICAgIGNvbnN0IG9uZVllYXJBZ28gPSBuZXcgRGF0ZSgpXHJcbiAgICAgIG9uZVllYXJBZ28uc2V0RnVsbFllYXIob25lWWVhckFnby5nZXRGdWxsWWVhcigpIC0gMSlcclxuICAgICAgZGF0ZUZpbHRlciA9IHsgYm9ycm93ZWRBdDogeyBndGU6IG9uZVllYXJBZ28gfSB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEubG9hbi5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgQU5EOiBbXHJcbiAgICAgICAgICBzZWFyY2ggPyB7XHJcbiAgICAgICAgICAgIE9SOiBbXHJcbiAgICAgICAgICAgICAgeyBib29rOiB7IHRpdGxlOiB7IGNvbnRhaW5zOiBzZWFyY2ggfSB9IH0sXHJcbiAgICAgICAgICAgICAgeyBib29rOiB7IGNvZGU6IHsgY29udGFpbnM6IHNlYXJjaCB9IH0gfSxcclxuICAgICAgICAgICAgICB7IHN0dWRlbnQ6IHsgbmFtZTogeyBjb250YWluczogc2VhcmNoIH0gfSB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICAgIH0gOiB7fSxcclxuICAgICAgICAgIHN0YXR1cyA/IHsgc3RhdHVzIH0gOiB7fSxcclxuICAgICAgICAgIGRhdGVGaWx0ZXJcclxuICAgICAgICBdXHJcbiAgICAgIH0sXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBib29rOiB0cnVlLFxyXG4gICAgICAgIHN0dWRlbnQ6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeTogeyBib3Jyb3dlZEF0OiAnZGVzYycgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIENyaWFyIG5vdm8gZW1wcsOpc3RpbW9cclxuICBzdGF0aWMgYXN5bmMgY3JlYXRlTG9hbihkYXRhOiBDcmVhdGVMb2FuRGF0YSkge1xyXG4gICAgLy8gVmVyaWZpY2FyIHNlIG8gbGl2cm8gZXhpc3RlIGUgdGVtIGV4ZW1wbGFyZXMgZGlzcG9uw612ZWlzXHJcbiAgICBjb25zdCBib29rID0gYXdhaXQgcHJpc21hLmJvb2suZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkOiBkYXRhLmJvb2tJZCB9XHJcbiAgICB9KVxyXG5cclxuICAgIGlmICghYm9vaykge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xpdnJvIG7Do28gZW5jb250cmFkbycpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGJvb2suY3VycmVudFF1YW50aXR5IDw9IDApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdOw6NvIGjDoSBleGVtcGxhcmVzIGRpc3BvbsOtdmVpcyBkZXN0ZSBsaXZybycpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIHNlIG8gYWx1bm8gasOhIHRlbSB1bSBlbXByw6lzdGltbyBhdGl2byBkZXN0ZSBsaXZyb1xyXG4gICAgY29uc3QgZXhpc3RpbmdMb2FuID0gYXdhaXQgcHJpc21hLmxvYW4uZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBib29rSWQ6IGRhdGEuYm9va0lkLFxyXG4gICAgICAgIHN0dWRlbnRJZDogZGF0YS5zdHVkZW50SWQsXHJcbiAgICAgICAgc3RhdHVzOiAnQUNUSVZFJ1xyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGlmIChleGlzdGluZ0xvYW4pIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdPIGFsdW5vIGrDoSBwb3NzdWkgdW0gZW1wcsOpc3RpbW8gYXRpdm8gZGVzdGUgbGl2cm8nKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIENyaWFyIG8gZW1wcsOpc3RpbW9cclxuICAgIGNvbnN0IGxvYW4gPSBhd2FpdCBwcmlzbWEubG9hbi5jcmVhdGUoe1xyXG4gICAgICBkYXRhLFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgYm9vazogdHJ1ZSxcclxuICAgICAgICBzdHVkZW50OiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gQXR1YWxpemFyIHF1YW50aWRhZGUgZGlzcG9uw612ZWwgZSBjb250YWRvciBkZSBlbXByw6lzdGltb3MgZG8gbGl2cm9cclxuICAgIGF3YWl0IEJvb2tTZXJ2aWNlLmluY3JlbWVudExvYW5zQ291bnQoZGF0YS5ib29rSWQpXHJcblxyXG4gICAgcmV0dXJuIGxvYW5cclxuICB9XHJcblxyXG5cclxuXHJcbiAgLy8gRGV2b2x2ZXIgZW1wcsOpc3RpbW9cclxuICBzdGF0aWMgYXN5bmMgcmV0dXJuTG9hbihpZDogc3RyaW5nKSB7XHJcbiAgICBjb25zdCBsb2FuID0gYXdhaXQgcHJpc21hLmxvYW4udXBkYXRlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIHN0YXR1czogJ1JFVFVSTkVEJyxcclxuICAgICAgICByZXR1cm5lZEF0OiBuZXcgRGF0ZSgpXHJcbiAgICAgIH0sXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBib29rOiB0cnVlLFxyXG4gICAgICAgIHN0dWRlbnQ6IHRydWVcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBBdHVhbGl6YXIgcXVhbnRpZGFkZSBkaXNwb27DrXZlbCBkbyBsaXZyb1xyXG4gICAgYXdhaXQgQm9va1NlcnZpY2UuZGVjcmVtZW50TG9hbnNDb3VudChsb2FuLmJvb2tJZClcclxuXHJcbiAgICByZXR1cm4gbG9hblxyXG4gIH1cclxuXHJcbiAgLy8gRGVsZXRhciBlbXByw6lzdGltb1xyXG4gIHN0YXRpYyBhc3luYyBkZWxldGVMb2FuKGlkOiBzdHJpbmcpIHtcclxuICAgIGNvbnN0IGxvYW4gPSBhd2FpdCBwcmlzbWEubG9hbi5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgc2VsZWN0OiB7IGJvb2tJZDogdHJ1ZSwgc3RhdHVzOiB0cnVlIH1cclxuICAgIH0pXHJcblxyXG4gICAgaWYgKGxvYW4gJiYgbG9hbi5zdGF0dXMgPT09ICdBQ1RJVkUnKSB7XHJcbiAgICAgIC8vIFNlIG8gZW1wcsOpc3RpbW8gZXN0w6EgYXRpdm8sIGRldm9sdmVyIG8gbGl2cm8gYW8gYWNlcnZvXHJcbiAgICAgIGF3YWl0IEJvb2tTZXJ2aWNlLmRlY3JlbWVudExvYW5zQ291bnQobG9hbi5ib29rSWQpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGF3YWl0IHByaXNtYS5sb2FuLmRlbGV0ZSh7XHJcbiAgICAgIHdoZXJlOiB7IGlkIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgZXN0YXTDrXN0aWNhcyBkZSBlbXByw6lzdGltb3NcclxuICBzdGF0aWMgYXN5bmMgZ2V0TG9hblN0YXRzKCkge1xyXG4gICAgY29uc3QgdG90YWxMb2FucyA9IGF3YWl0IHByaXNtYS5sb2FuLmNvdW50KClcclxuICAgIGNvbnN0IGFjdGl2ZUxvYW5zID0gYXdhaXQgcHJpc21hLmxvYW4uY291bnQoe1xyXG4gICAgICB3aGVyZTogeyBzdGF0dXM6ICdBQ1RJVkUnIH1cclxuICAgIH0pXHJcbiAgICBjb25zdCByZXR1cm5lZExvYW5zID0gYXdhaXQgcHJpc21hLmxvYW4uY291bnQoe1xyXG4gICAgICB3aGVyZTogeyBzdGF0dXM6ICdSRVRVUk5FRCcgfVxyXG4gICAgfSlcclxuICAgIGNvbnN0IG92ZXJkdWVMb2FucyA9IGF3YWl0IHByaXNtYS5sb2FuLmNvdW50KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBzdGF0dXM6ICdBQ1RJVkUnLFxyXG4gICAgICAgIGR1ZURhdGU6IHsgbHQ6IG5ldyBEYXRlKCkgfVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRvdGFsTG9hbnMsXHJcbiAgICAgIGFjdGl2ZUxvYW5zLFxyXG4gICAgICByZXR1cm5lZExvYW5zLFxyXG4gICAgICBvdmVyZHVlTG9hbnNcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIEJ1c2NhciBlbXByw6lzdGltb3MgZW0gYXRyYXNvXHJcbiAgc3RhdGljIGFzeW5jIGdldE92ZXJkdWVMb2FucygpIHtcclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEubG9hbi5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgc3RhdHVzOiAnQUNUSVZFJyxcclxuICAgICAgICBkdWVEYXRlOiB7IGx0OiBuZXcgRGF0ZSgpIH1cclxuICAgICAgfSxcclxuICAgICAgaW5jbHVkZToge1xyXG4gICAgICAgIGJvb2s6IHRydWUsXHJcbiAgICAgICAgc3R1ZGVudDogdHJ1ZVxyXG4gICAgICB9LFxyXG4gICAgICBvcmRlckJ5OiB7IGR1ZURhdGU6ICdhc2MnIH1cclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICAvLyBCdXNjYXIgZW1wcsOpc3RpbW9zIHBvciBwZXLDrW9kb1xyXG4gIHN0YXRpYyBhc3luYyBnZXRMb2Fuc0J5UGVyaW9kKHBlcmlvZDogc3RyaW5nKSB7XHJcbiAgICBsZXQgc3RhcnREYXRlID0gbmV3IERhdGUoKVxyXG4gICAgXHJcbiAgICBzd2l0Y2ggKHBlcmlvZCkge1xyXG4gICAgICBjYXNlICdtZXMnOlxyXG4gICAgICAgIHN0YXJ0RGF0ZS5zZXRNb250aChzdGFydERhdGUuZ2V0TW9udGgoKSAtIDEpXHJcbiAgICAgICAgYnJlYWtcclxuICAgICAgY2FzZSAndHJpbWVzdHJlJzpcclxuICAgICAgICBzdGFydERhdGUuc2V0TW9udGgoc3RhcnREYXRlLmdldE1vbnRoKCkgLSAzKVxyXG4gICAgICAgIGJyZWFrXHJcbiAgICAgIGNhc2UgJ2Fubyc6XHJcbiAgICAgICAgc3RhcnREYXRlLnNldEZ1bGxZZWFyKHN0YXJ0RGF0ZS5nZXRGdWxsWWVhcigpIC0gMSlcclxuICAgICAgICBicmVha1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKDApIC8vIERlc2RlIG8gaW7DrWNpb1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhd2FpdCBwcmlzbWEubG9hbi5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7XHJcbiAgICAgICAgYm9ycm93ZWRBdDogeyBndGU6IHN0YXJ0RGF0ZSB9XHJcbiAgICAgIH0sXHJcbiAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICBib29rOiB0cnVlLFxyXG4gICAgICAgIHN0dWRlbnQ6IHRydWVcclxuICAgICAgfSxcclxuICAgICAgb3JkZXJCeTogeyBib3Jyb3dlZEF0OiAnZGVzYycgfVxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIC8vIEJ1c2NhciBsaXZyb3MgZGlzcG9uw612ZWlzIHBhcmEgZW1wcsOpc3RpbW9cclxuICBzdGF0aWMgYXN5bmMgZ2V0QXZhaWxhYmxlQm9va3MoKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcHJpc21hLmJvb2suZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZToge1xyXG4gICAgICAgIGN1cnJlbnRRdWFudGl0eTogeyBndDogMCB9LFxyXG4gICAgICAgIGRlbGV0ZWRBdDogbnVsbFxyXG4gICAgICB9LFxyXG4gICAgICBvcmRlckJ5OiB7IHRpdGxlOiAnYXNjJyB9XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgLy8gVmVyaWZpY2FyIHNlIGFsdW5vIHBvZGUgZW1wcmVzdGFyIHVtIGxpdnJvIGVzcGVjw61maWNvXHJcbiAgc3RhdGljIGFzeW5jIGNhblN0dWRlbnRCb3Jyb3dCb29rKHN0dWRlbnRJZDogc3RyaW5nLCBib29rSWQ6IHN0cmluZykge1xyXG4gICAgY29uc3QgZXhpc3RpbmdMb2FuID0gYXdhaXQgcHJpc21hLmxvYW4uZmluZEZpcnN0KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBib29rSWQsXHJcbiAgICAgICAgc3R1ZGVudElkLFxyXG4gICAgICAgIHN0YXR1czogJ0FDVElWRSdcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gIWV4aXN0aW5nTG9hblxyXG4gIH1cclxufSAiXSwibmFtZXMiOlsicHJpc21hIiwiQm9va1NlcnZpY2UiLCJMb2FuU2VydmljZSIsImdldEFsbExvYW5zIiwibG9hbiIsImZpbmRNYW55IiwiaW5jbHVkZSIsImJvb2siLCJzdHVkZW50Iiwib3JkZXJCeSIsImJvcnJvd2VkQXQiLCJnZXRMb2FuQnlJZCIsImlkIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwiZ2V0TG9hbnNCeUZpbHRlcnMiLCJmaWx0ZXJzIiwic2VhcmNoIiwic3RhdHVzIiwicGVyaW9kIiwiZGF0ZUZpbHRlciIsIm9uZU1vbnRoQWdvIiwiRGF0ZSIsInNldE1vbnRoIiwiZ2V0TW9udGgiLCJndGUiLCJ0aHJlZU1vbnRoc0FnbyIsIm9uZVllYXJBZ28iLCJzZXRGdWxsWWVhciIsImdldEZ1bGxZZWFyIiwiQU5EIiwiT1IiLCJ0aXRsZSIsImNvbnRhaW5zIiwiY29kZSIsIm5hbWUiLCJjcmVhdGVMb2FuIiwiZGF0YSIsImJvb2tJZCIsIkVycm9yIiwiY3VycmVudFF1YW50aXR5IiwiZXhpc3RpbmdMb2FuIiwiZmluZEZpcnN0Iiwic3R1ZGVudElkIiwiY3JlYXRlIiwiaW5jcmVtZW50TG9hbnNDb3VudCIsInJldHVybkxvYW4iLCJ1cGRhdGUiLCJyZXR1cm5lZEF0IiwiZGVjcmVtZW50TG9hbnNDb3VudCIsImRlbGV0ZUxvYW4iLCJzZWxlY3QiLCJkZWxldGUiLCJnZXRMb2FuU3RhdHMiLCJ0b3RhbExvYW5zIiwiY291bnQiLCJhY3RpdmVMb2FucyIsInJldHVybmVkTG9hbnMiLCJvdmVyZHVlTG9hbnMiLCJkdWVEYXRlIiwibHQiLCJnZXRPdmVyZHVlTG9hbnMiLCJnZXRMb2Fuc0J5UGVyaW9kIiwic3RhcnREYXRlIiwiZ2V0QXZhaWxhYmxlQm9va3MiLCJndCIsImRlbGV0ZWRBdCIsImNhblN0dWRlbnRCb3Jyb3dCb29rIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/loans.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Freports%2Floans%2Froute&page=%2Fapi%2Freports%2Floans%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Freports%2Floans%2Froute.ts&appDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CMiguel%5Cprojetos%5Cbiblioteca&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();